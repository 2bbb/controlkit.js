var ControlKit=ControlKit||{};ControlKit.Event=function(a,b,c){this.sender=a;this.type=b;this.data=c};ControlKit.Event.prototype.clone=function(){return new ControlKit.Event(this.sender,this.type,this.data)};ControlKit.EventDispatcher=function(){this._listeners=[]};ControlKit.EventDispatcher.prototype={addEventListener:function(b,c,a){this._listeners[b]=this._listeners[b]||[];this._listeners[b].push({obj:c,method:a})},dispatchEvent:function(e){var d=e.type;if(!this.hasEventListener(d)){return}var c=this._listeners[d];var b=-1,a=c.length;var f,g;while(++b<a){f=c[b].obj;g=c[b].method;if(!f[g]){throw f+" has no method "+g}f[g](e)}},removeEventListener:function(c,d,e){if(!this.hasEventListener(c)){return}var b=this._listeners[c];var a=b.length;while(--a>-1){if(b[a].obj==d&&b[a].method==e){b.splice(a,1);if(b.length==0){delete this._listeners[c]}break}}},removeAllEventListeners:function(){this._listeners=[]},hasEventListener:function(a){return this._listeners[a]!=undefined&&this._listeners[a]!=null}};ControlKit.EventType={VALUE_UPDATED:"valueUpdated",UPDATE_VALUE:"updateValue",SELECT_TRIGGERED:"selectTrigger",TRIGGER_SELECT:"triggerSelect",PANEL_MOVE_BEGIN:"panelMoveBegin",PANEL_MOVE:"panelMove",PANEL_MOVE_END:"panelMoveEnd",PANEL_SHOW:"panelShow",PANEL_HIDE:"panelHide",PANEL_SCROLL_WRAP_ADDED:"panelScrollWrapAdded",PANEL_SCROLL_WRAP_REMOVED:"panelScrollWrapRemoved",SUBGROUP_TRIGGER:"subGroupTrigger",COMPONENTS_ENABLE:"enableCompo",COMPONENTS_DISABLE:"disableComps",SUBGROUP_ENABLE:"enableSubGroup",SUBGROUP_DISABLE:"disableSubGroup",INDEX_ORDER_CHANGED:"indexOrderChanged",CHANGE_INDEX_ORDER:"changeIndexOrder",SCROLL_BEGIN:"scrollBegin",SCROLL:"scroll",SCROLL_END:"scrollEnd",INPUT_SELECTDRAG_START:"inputSelectDragStart",INPUT_SELECTDRAG:"inputSelectDrag",INPUT_SELECTDRAG_END:"inputSelectDragEnd",INPUT_SELECT_DRAG:"inputSelectDrag",HISTORY_STATE_PUSH:"historyStatePush",HISTORY_STATE_POP:"historyStatePop",GROUP_SIZE_CHANGE:"groupSizeChange",GROUP_LIST_SIZE_CHANGE:"groupListSizeChange",GROUP_SIZE_UPDATE:"groupSizeUpdate",PANEL_SIZE_CHANGE:"panelSizeChange",UPDATE_MENU:"updateMenu"};ControlKit.ColorMode={RGB:"rgb",HSV:"hsv",HEX:"hex",RGBfv:"rgbfv"};ControlKit.LayoutMode={LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom",NONE:"none"};ControlKit.Metric={COMPONENT_MIN_HEIGHT:25,STROKE_SIZE:1,PADDING_WRAPPER:12,PADDING_OPTIONS:2,PADDING_PRESET:20,SCROLLBAR_TRACK_PADDING:2,FUNCTION_PLOTTER_LABEL_TICK_SIZE:6};ControlKit.Preset={HISTORY_MAX_STATES:30,NUMBER_INPUT_SHIFT_MULTIPLIER:10,FUNCTION_PLOTTER_NON_IMPLICIT_UNIT_X:1,FUNCTION_PLOTTER_NON_IMPLICIT_UNIT_Y:1,FUNCTION_PLOTTER_IMPLICIT_UNIT_X:0.25,FUNCTION_PLOTTER_IMPLICIT_UNIT_Y:0.25,FUNCTION_PLOTTER_UNIT_MIN:0.15,FUNCTION_PLOTTER_UNIT_MAX:4,FUNCTION_PLOTTER_NON_IMPLICIT_SCALE:10,FUNCTION_PLOTTER_IMPLICIT_SCALE:1,FUNCTION_PLOTTER_SCALE_MIN:0.02,FUNCTION_PLOTTER_SCALE_MAX:25,FUNCTION_PLOTTER_IMPLICIT_AXES_COLOR:"rgba(255,255,255,0.75)",FUNCTION_PLOTTER_IMPLICIT_GRID_COLOR:"rgba(25,25,25,0.75)",FUNCTION_PLOTTER_NON_IMPLICIT_AXES_COLOR:"rgb(54,60,64)",FUNCTION_PLOTTER_NON_IMPLICIT_GRID_COLOR:"rgb(25,25,25)",FUNCTION_PLOTTER_CIRCLE_LABEL_RADIUS:3,FUNCTION_PLOTTER_CIRCLE_LABEL_FILL:"rgb(255,255,255)",FUNCTION_PLOTTER_CIRCLE_STROKE:"#b12334"};ControlKit.Default={KIT_TRIGGER:false,KIT_HISTORY:false,KIT_PANELS_CLOSABLE:true,KIT_OPACITY:1,PANEL_POSITION:null,PANEL_WIDTH:300,PANEL_HEIGHT:null,PANEL_WIDTH_MIN:100,PANEL_WIDTH_MAX:600,PANEL_RATIO:40,PANEL_LABEL:"Control Panel",PANEL_VALIGN:ControlKit.LayoutMode.TOP,PANEL_ALIGN:ControlKit.LayoutMode.RIGHT,PANEL_DOCK:{align:ControlKit.LayoutMode.RIGHT,resizable:true},PANEL_ENABLE:true,PANEL_OPACITY:1,PANEL_FIXED:true,PANEL_VCONSTRAIN:true,FUNCTION_PLOTTER_SHOW_MIN_MAX_LABELS:true,COLOR_COLOR_MODE:ControlKit.ColorMode.HEX,COLOR_PICKER_VALUE_HUE:200,COLOR_PICKER_VALUE_SAT:50,COLOR_PICKER_VALUE_VAL:50};ControlKit.History=function(){ControlKit.EventDispatcher.apply(this,arguments);this._states=[];this._isDisabled=false};ControlKit.History.prototype=Object.create(ControlKit.EventDispatcher.prototype);ControlKit.History.prototype.pushState=function(b,c,d){if(this._isDisabled){return}var a=this._states,e=ControlKit.Preset.HISTORY_MAX_STATES;if(a.length>=e){a.shift()}a.push({object:b,key:c,value:d});this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.HISTORY_STATE_PUSH,null))};ControlKit.History.prototype.getState=function(b,d){var a=this._states,g=a.length;if(g==0){return null}var f,e;var c=-1;while(++c<g){f=a[c];if(f.object===b){if(f.key===d){e=f.value;break}}}return e};ControlKit.History.prototype.popState=function(){if(this._isDisabled){return}var a=this._states;if(a.length<1){return}var b=a.pop();b.object[b.key]=b.value;this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.HISTORY_STATE_POP,null))};ControlKit.History.prototype.getNumStates=function(){return this._states.length};ControlKit.History._instance=null;ControlKit.History.init=function(){return ControlKit.History._instance=new ControlKit.History()};ControlKit.History.getInstance=function(){return ControlKit.History._instance};ControlKit.History.prototype.enable=function(){this._isDisabled=false};ControlKit.History.prototype.disable=function(){this._isDisabled=true};ControlKit.History.prototype.isDisabled=function(){return this._isDisabled};ControlKit.Error={COLOR_FORMAT_HEX:"Color format should be hex. Set colorMode to rgb, rgbfv or hsv.",COLOR_FORMAT_RGB_RGBFV_HSV:"Color format should be rgb, rgbfv or hsv. Set colorMode to hex.",COLOR_PRESET_FORMAT_HEX:"Preset color format should be hex.",COLOR_PRESET_FORMAT_RGB_RGBFV_HSV:"Preset color format should be rgb, rgbfv or hsv.",COMPONENT_OBJECT:"Object ",COMPONENT_OBJECT_MEMBER_REFERENCE:" has no member ",TYPE:" should be of type ",COMPONENT_FUNCTION_LENGTH:"Function should be of form f(x) or f(x,y).",END:"."};ControlKit.ErrorUtil={ReferenceError:function(a,b){return(a[b]===undefined)},TypeError:function(a,c,b){return Object.prototype.toString.call(a[c])!==Object.prototype.toString.call(b)}};ControlKit.Kit=function(h,g){ControlKit.EventDispatcher.apply(this,arguments);var e=null;if(!h){e=new ControlKit.Node(ControlKit.NodeType.DIV);document.body.appendChild(e.getElement())}else{e=ControlKit.Node.getNodeById(h)}e.setProperty("id",ControlKit.CSS.ControlKit);g=g||{};g.trigger=g.trigger===undefined?ControlKit.Default.KIT_TRIGGER:g.fixed;g.history=g.history===undefined?ControlKit.Default.KIT_HISTORY:g.history;g.panelsClosable=g.panelsClosable===undefined?ControlKit.Default.KIT_PANELS_CLOSABLE:g.panelsClosable;g.opacity=g.opacity||ControlKit.Default.KIT_OPACITY;this._node=e;this._panels=[];this._isDisabled=false;this._historyEnabled=g.history;var f=ControlKit.History.init();f.addEventListener(ControlKit.EventType.HISTORY_STATE_PUSH,this,"onHistoryStatePush");f.addEventListener(ControlKit.EventType.HISTORY_STATE_POP,this,"onHistoryStatePop");if(!this._historyEnabled){f.disable()}var d=ControlKit.Mouse.init(),c=ControlKit.Picker.init(this.getNode()),b=ControlKit.Options.init(this.getNode());if(g.trigger){var a=new ControlKit.Node(ControlKit.NodeType.DIV);a.setProperty("id",ControlKit.CSS.Trigger);a.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onTriggerDown.bind(this));document.body.appendChild(a.getElement())}if(g.opacity!=1&&g.opacity!=0){e.setStyleProperty("opacity",g.opacity)}ControlKit.Kit._instance=this};ControlKit.Kit.prototype=Object.create(ControlKit.EventDispatcher.prototype);ControlKit.Kit.prototype._onTriggerDown=function(){var a=this._isDisabled=!this._isDisabled;this._node.setStyleProperty("visibility",a?"hidden":"visible")};ControlKit.Kit.prototype.onValueUpdated=function(a){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.UPDATE_VALUE,{origin:a.sender}))};ControlKit.Kit.prototype.onSelectTriggered=function(a){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.TRIGGER_SELECT,{origin:a.sender}))};ControlKit.Kit.prototype.addPanel=function(b){var a=new ControlKit.Panel(this,b);this._panels.push(a);return a};ControlKit.Kit.prototype.update=function(){if(this._isDisabled){return}var g=-1,f,c;var e=this._panels,b,a,h,d;while(++g<e.length){b=e[g];if(b.isDisabled()){continue}a=b.getGroups();f=-1;while(++f<a.length){h=a[f].getComponents();c=-1;while(++c<h.length){d=h[c];if(d.isDisabled()){continue}if(d instanceof ControlKit.ValuePlotter||d instanceof ControlKit.StringOutput||d instanceof ControlKit.NumberOutput){d.update()}}}}};ControlKit.Kit.prototype.historyIsEnabled=function(){return this._historyEnabled};ControlKit.Kit.prototype.enable=function(){this._isDisabled=false};ControlKit.Kit.prototype.disable=function(){this._isDisabled=true};ControlKit.Kit.prototype.disableAllPanels=function(){var a=-1,b=this._panels;while(++a<b.length){b[a].enable()}};ControlKit.Kit.prototype.enableAllPanels=function(){var a=-1,b=this._panels;while(++a<b.length){b[a].disable()}};ControlKit.Kit.prototype.onHistoryStatePush=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.UPDATE_MENU,null))};ControlKit.Kit.prototype.onHistoryStatePop=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.UPDATE_VALUE,{origin:null}));this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.UPDATE_MENU,null))};ControlKit.Kit.prototype.getNode=function(){return this._node};ControlKit.getKitInstance=function(){return ControlKit.Kit._instance};ControlKit.CSS={ControlKit:"controlKit",Panel:"panel",Head:"head",Label:"label",Menu:"menu",Wrap:"wrap",MenuBtnClose:"btnClose",MenuBtnHide:"btnHide",MenuBtnShow:"btnShow",MenuBtnUndo:"btnUndo",WrapInputWPreset:"inputWPresetWrap",WrapColorWPreset:"colorWPresetWrap",HeadInactive:"headInactive",PanelHeadInactive:"panelHeadInactive",GroupList:"groupList",Group:"group",SubGroupList:"subGroupList",SubGroup:"subGroup",TextAreaWrap:"textAreaWrap",IconArrowUpBig:"iconArrowUpBig",Button:"button",WrapSlider:"wrapSlider",SliderWrap:"sliderWrap",SliderSlot:"sliderSlot",SliderHandle:"sliderHandle",ArrowBMin:"arrowBMin",ArrowBMax:"arrowBMax",ArrowBSubMin:"arrowBSubMin",ArrowBSubMax:"arrowBSubMax",ArrowSMin:"arrowSMin",ArrowSMax:"arrowSMax",Select:"select",SelectActive:"selectActive",Options:"options",OptionsSelected:"liSelected",SelectColor:"selectColor",PresetBtn:"presetBtn",PresetBtnActive:"presetBtnActive",CanvasListItem:"canvasListItem",CanvasWrap:"canvasWrap",SVGListItem:"svgListItem",SVGWrap:"svgWrap",GraphSliderXWrap:"graphSliderXWrap",GraphSliderYWrap:"graphSliderYWrap",GraphSliderX:"graphSliderX",GraphSliderY:"graphSliderY",GraphSliderXHandle:"graphSliderXHandle",GraphSliderYHandle:"graphSliderYHandle",Picker:"picker",PickerPalleteWrap:"palleteWrap",PickerFieldWrap:"fieldWrap",PickerInputWrap:"inputWrap",PickerInputField:"inputField",PickerControlsWrap:"controlsWrap",PickerColorContrast:"colorContrast",PickerHandleField:"indicator",PickerHandleSlider:"indicator",Color:"color",ScrollBar:"scrollBar",ScrollWrap:"scrollWrap",ScrollbarBtnUp:"btnUp",ScrollbarBtnDown:"btnDown",ScrollbarTrack:"track",ScrollbarThumb:"thumb",ScrollBuffer:"scrollBuffer",Trigger:"controlKitTrigger",SizeHandle:"sizeHandle"};ControlKit.DocumentEventType={MOUSE_MOVE:"mousemove",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",WINDOW_RESIZE:"resize"};ControlKit.Mouse=function(){this._pos=[0,0];document.addEventListener(ControlKit.DocumentEventType.MOUSE_MOVE,this._onDocumentMouseMove.bind(this))};ControlKit.Mouse.prototype._onDocumentMouseMove=function(c){var b=0,a=0;if(!c){c=window.event}if(c.pageX){b=c.pageX;a=c.pageY}else{if(c.clientX){b=c.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;a=c.clientY+document.body.scrollTop+document.documentElement.scrollTop}}this._pos[0]=b;this._pos[1]=a};ControlKit.Mouse.prototype.getPosition=function(){return this._pos};ControlKit.Mouse.prototype.getX=function(){return this._pos[0]};ControlKit.Mouse.prototype.getY=function(){return this._pos[1]};ControlKit.Mouse.init=function(){if(!ControlKit.Mouse._instance){ControlKit.Mouse._instance=new ControlKit.Mouse()}};ControlKit.Mouse.getInstance=function(){return ControlKit.Mouse._instance};ControlKit.NodeEventType={MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",KEY_DOWN:"keydown",KEY_UP:"keyup",CHANGE:"change",FINISH:"finish",DBL_CLICK:"dblclick",ON_CLICK:"click",SELECT_START:"selectstart",DRAG_START:"dragstart",DRAG:"drag",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_OVER:"dragover",DRAG_LEAVE:"dragleave",RESIZE:"resize"};ControlKit.NodeType={DIV:"div",INPUT_TEXT:"text",INPUT_BUTTON:"button",INPUT_SELECT:"select",INPUT_CHECKBOX:"checkbox",OPTION:"option",LIST:"ul",LIST_ITEM:"li",SPAN:"span",TEXTAREA:"textarea"};ControlKit.Node=function(){this._element=null;if(arguments.length==1){var a=arguments[0];if(a!=ControlKit.NodeType.INPUT_TEXT&&a!=ControlKit.NodeType.INPUT_BUTTON&&a!=ControlKit.NodeType.INPUT_SELECT&&a!=ControlKit.NodeType.INPUT_CHECKBOX){this._element=document.createElement(a)}else{this._element=document.createElement("input");this._element.type=a}}};ControlKit.Node.prototype={addChild:function(a){this._element.appendChild(a.getElement());return a},addChildren:function(){var b=-1,a=arguments.length,c=this._element;while(++b<a){c.appendChild(arguments[b].getElement())}return this},addChildAt:function(b,a){this._element.insertBefore(b.getElement(),this._element.children[a]);return b},removeChild:function(a){if(!this.contains(a)){return null}this._element.removeChild(a.getElement());return a},removeChildren:function(){var b=-1,a=arguments.length,c=this._element;while(++b<a){c.removeChild(arguments[b].getElement())}return this},removeChildAt:function(b,a){if(!this.contains(b)){return null}this._element.removeChild(b.getElement());return b},removeAllChildren:function(){var a=this._element;while(a.hasChildNodes()){a.removeChild(a.lastChild)}return this},setWidth:function(a){this._element.style.width=a+"px";return this},getWidth:function(){return this._element.offsetWidth},setHeight:function(a){this._element.style.height=a+"px";return this},getHeight:function(){return this._element.offsetHeight},setPosition:function(a,b){return this.setPosition(a).setPosition(b)},setPositionX:function(a){this._element.style.marginLeft=a+"px";return this},setPositionY:function(a){this._element.style.marginTop=a+"px";return this},setPositionGlobal:function(a,b){return this.setPositionGlobalX(a).setPositionGlobalY(b)},setPositionGlobalX:function(a){this._element.style.left=a+"px";return this},setPositionGlobalY:function(a){this._element.style.top=a+"px";return this},getPosition:function(){return[this.getPositionX(),this.getPositionY()]},getPositionX:function(){return this._element.offsetLeft},getPositionY:function(){return this._element.offsetTop},getPositionGlobal:function(){var b=[0,0],a=this._element;while(a){b[0]+=a.offsetLeft;b[1]+=a.offsetTop;a=a.offsetParent}return b},getPositionGlobalX:function(){var b=0,a=this._element;while(a){b+=a.offsetLeft;a=a.offsetParent}return b},getPositionGlobalY:function(){var b=0,a=this._element;while(a){b+=a.offsetTop;a=a.offsetParent}return b},addEventListener:function(b,c,a){this._element.addEventListener(b,c,a);return this},removeEventListener:function(b,c,a){this._element.removeEventListener(b,c,a);return this},setStyleClass:function(a){this._element.className=a;return this},setStyleProperty:function(b,a){this._element.style[b]=a;return this},getStyleProperty:function(a){return this._element.style[a]},setStyleProperties:function(a){for(var b in a){this._element.style[b]=a[b]}return this},deleteStyleClass:function(){this._element.className="";return this},deleteStyleProperty:function(a){this._element.style[a]="";return this},deleteStyleProperties:function(a){for(var b in a){this._element.style[b]=""}return this},getChildAt:function(a){return new ControlKit.Node().setElement(this._element.children[a])},getChildIndex:function(a){return this._indexOf(this._element,a.getElement())},getNumChildren:function(){return this._element.children.length},getFirstChild:function(){return new ControlKit.Node().setElement(this._element.firstChild)},getLastChild:function(){return new ControlKit.Node().setElement(this._element.lastChild)},hasChildren:function(){return this._element.children.length!=0},contains:function(a){return this._indexOf(this._element,a.getElement())!=-1},_indexOf:function(a,b){return Array.prototype.indexOf.call(a.children,b)},setProperty:function(b,a){this._element[b]=a;return this},setProperties:function(a){for(var b in a){this._element[b]=a[b]}return this},getProperty:function(a){return this._element[a]},setElement:function(a){this._element=a;return this},getElement:function(){return this._element},getStyle:function(){return this._element.style},getParent:function(){return new ControlKit.Node().setElement(this._element.parentNode)}};ControlKit.Node.getNodeByElement=function(a){return new ControlKit.Node().setElement(a)};ControlKit.Node.getNodeById=function(a){return new ControlKit.Node().setElement(document.getElementById(a))};ControlKit.Component=function(d,c){ControlKit.EventDispatcher.apply(this,arguments);c=d.usesLabels()?c:"none";this._parent=d;this._isDisabled=false;var b=this._node=new ControlKit.Node(ControlKit.NodeType.LIST_ITEM),a=this._wrapNode=new ControlKit.Node(ControlKit.NodeType.DIV);a.setStyleClass(ControlKit.CSS.Wrap);b.addChild(a);if(c){if(c.length!=0&&c!="none"){var e=this._lablNode=new ControlKit.Node(ControlKit.NodeType.SPAN);e.setStyleClass(ControlKit.CSS.Label);e.setProperty("innerHTML",c);b.addChild(e)}if(c=="none"){a.setStyleProperty("marginLeft","0");a.setStyleProperty("width","100%")}}this._parent.addEventListener(ControlKit.EventType.COMPONENTS_ENABLE,this,"onEnable");this._parent.addEventListener(ControlKit.EventType.COMPONENTS_DISABLE,this,"onDisable");this._parent.addComponentNode(b)};ControlKit.Component.prototype=Object.create(ControlKit.EventDispatcher.prototype);ControlKit.Component.prototype.enable=function(){this._isDisabled=false};ControlKit.Component.prototype.disable=function(){this._isDisabled=true};ControlKit.Component.prototype.isEnabled=function(){return !this._isDisabled};ControlKit.Component.prototype.isDisabled=function(){return this._isDisabled};ControlKit.Component.prototype.onEnable=function(){this.enable()};ControlKit.Component.prototype.onDisable=function(){this.disable()};ControlKit.ObjectComponent=function(b,a,d,e){if(ControlKit.ErrorUtil.ReferenceError(a,d)){throw new ReferenceError(ControlKit.Error.COMPONENT_OBJECT+a.constructor.name+ControlKit.Error.COMPONENT_OBJECT_MEMBER_REFERENCE+d+ControlKit.Error.END)}e=e||{};e.label=e.label||d;ControlKit.Component.apply(this,[b,e.label]);this._object=a;this._key=d;this._onChange=function(){};this._onFinish=function(){};var c=ControlKit.getKitInstance();c.addEventListener(ControlKit.EventType.UPDATE_VALUE,this,"onValueUpdate");this.addEventListener(ControlKit.EventType.VALUE_UPDATED,c,"onValueUpdated")};ControlKit.ObjectComponent.prototype=Object.create(ControlKit.Component.prototype);ControlKit.ObjectComponent.prototype.applyValue=function(){};ControlKit.ObjectComponent.prototype.pushHistoryState=function(){var b=this._object,a=this._key;ControlKit.History.getInstance().pushState(b,a,b[a])};ControlKit.ObjectComponent.prototype.onValueUpdate=function(a){};ControlKit.ObjectComponent.prototype.setValue=function(a){this._object[this._key]=a};ControlKit.SVGComponent=function(e,d,f,h){ControlKit.ObjectComponent.apply(this,arguments);var a=this._wrapNode;a.setStyleClass(ControlKit.CSS.SVGWrap);var g=a.getWidth();var c=this._svg=this._createSVGObject("svg");c.setAttribute("version","1.2");c.setAttribute("baseProfile","tiny");c.setAttribute("preserveAspectRatio","true");a.getElement().appendChild(c);var b=this._svgRoot=c.appendChild(this._createSVGObject("g"));b.setAttribute("transform","translate(0.5 0.5)");this._svgSetSize(g,g);this._updateHeight();this._node.setStyleClass(ControlKit.CSS.SVGListItem);this._parent.addEventListener(ControlKit.EventType.GROUP_SIZE_CHANGE,this,"onGroupSizeChange");this.addEventListener(ControlKit.EventType.GROUP_SIZE_UPDATE,this._parent,"onGroupSizeUpdate")};ControlKit.SVGComponent.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.SVGComponent.prototype._updateHeight=function(){var a=Number(this._svg.getAttribute("height"));this._wrapNode.setHeight(a);this._node.setHeight(a+ControlKit.Metric.PADDING_WRAPPER)};ControlKit.SVGComponent.prototype._redraw=function(){};ControlKit.SVGComponent.prototype.onGroupSizeChange=function(){var a=this._wrapNode.getWidth();this._svgSetSize(a,a);this._updateHeight();this._redraw()};ControlKit.SVGComponent.prototype._createSVGObject=function(a){return document.createElementNS("http://www.w3.org/2000/svg",a)};ControlKit.SVGComponent.prototype._svgSetSize=function(c,a){var b=this._svg;b.setAttribute("width",c);b.setAttribute("height",a);b.setAttribute("viewbox","0 0 "+c+" "+a)};ControlKit.SVGComponent.prototype._pathCmdMoveTo=function(a,b){return"M "+a+" "+b+" "};ControlKit.SVGComponent.prototype._pathCmdLineTo=function(a,b){return"L "+a+" "+b+" "};ControlKit.SVGComponent.prototype._pathCmdClose=function(){return"Z"};ControlKit.SVGComponent.prototype._pathCmdLine=function(b,d,a,c){return"M "+b+" "+d+" L "+a+" "+c};ControlKit.SVGComponent.prototype._pathCmdBezierCubic=function(c,b,i,g,e,f,d,a,h){return"M "+b+" "+i+" C "+g+" "+e+", "+f+" "+d+", "+a+" "+h};ControlKit.SVGComponent.prototype._pathCmdBezierQuadratic=function(f,c,e,a,g,b,d){return"M "+c+" "+e+" Q "+a+" "+g+", "+b+" "+d};ControlKit.ColorUtil={HSV2RGB:function(o,j,i){var k=360,w=100,v=100;var n=0,h=0,e=0;o=o%k;i=Math.max(e,Math.min(i,v))/v*255;if(j<=h){i=Math.round(i);return[i,i,i]}else{if(j>w){j=w}}j=j/w;var l=Math.floor(o/60)%6,s=(o/60)-l,d=i*(1-j),c=i*(1-s*j),x=i*(1-(1-s)*j);var a=0,m=0,u=0;switch(l){case 0:a=i;m=x;u=d;break;case 1:a=c;m=i;u=d;break;case 2:a=d;m=i;u=x;break;case 3:a=d;m=c;u=i;break;case 4:a=x;m=d;u=i;break;case 5:a=i;m=d;u=c;break;default:break}a=Math.round(a);m=Math.round(m);u=Math.round(u);return[a,m,u]},RGB2HSV:function(a,e,f){var d=0,m=0,k=0;a=a/255;e=e/255;f=f/255;var j=Math.min(a,Math.min(e,f)),l=Math.max(a,Math.max(e,f));if(j==l){k=j;return[0,0,Math.round(k)]}var i=(a==j)?e-f:((f==j)?a-e:f-a),c=(a==j)?3:((f==j)?1:5);d=Math.round(60*(c-i/(l-j)));m=Math.round((l-j)/l*100);k=Math.round(l*100);return[d,m,k]},RGB2HEX:function(d,c,a){return"#"+((1<<24)+(d<<16)+(c<<8)+a).toString(16).slice(1)},RGBfv2HEX:function(d,c,a){return ControlKit.ColorUtil.RGB2HEX(Math.floor(d*255),Math.floor(c*255),Math.floor(a*255))},HSV2HEX:function(d,c,a){var b=ControlKit.ColorUtil.HSV2RGB(d,c,a);return ControlKit.ColorUtil.RGB2HEX(b[0],b[1],b[2])},HEX2RGB:function(c){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;c=c.replace(b,function(e,h,f,d){return h+h+f+f+d+d});var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c);return a?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:null},isValidHEX:function(a){return/^#[0-9A-F]{6}$/i.test(a)},isValidRGB:function(d,c,a){return d>=0&&d<=255&&c>=0&&c<=255&&a>=0&&a<=255},isValidRGBfv:function(d,c,a){return d>=0&&d<=1&&c>=0&&c<=1&&a>=0&&a<=1}};ControlKit.ScrollBar=function(a,g,c){this._parentNode=a;this._targetNode=g;this._wrapHeight=c;var e=this._wrapNode=new ControlKit.Node(ControlKit.NodeType.DIV),f=this._node=new ControlKit.Node(ControlKit.NodeType.DIV),b=this._trackNode=new ControlKit.Node(ControlKit.NodeType.DIV),d=this._thumbNode=new ControlKit.Node(ControlKit.NodeType.DIV);a.removeChild(g);a.addChild(e);a.addChildAt(f,0);e.addChild(g);f.addChild(b);b.addChild(d);e.setStyleClass(ControlKit.CSS.ScrollWrap);f.setStyleClass(ControlKit.CSS.ScrollBar);b.setStyleClass(ControlKit.CSS.ScrollbarTrack);d.setStyleClass(ControlKit.CSS.ScrollbarThumb);this._scrollHeight=0;this._scrollUnit=0;this._scrollMin=0;this._scrollMax=1;this._scrollPos=0;d.setPositionY(ControlKit.Metric.SCROLLBAR_TRACK_PADDING);d.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onThumbDragStart.bind(this));this._isValid=false;this._isDisabled=false};ControlKit.ScrollBar.prototype={update:function(){var h=this._targetNode,b=this._thumbNode;var g=ControlKit.Metric.SCROLLBAR_TRACK_PADDING;var c=this._wrapHeight,a=h.getHeight(),e=c-g*2;b.setHeight(e);var d=c/a;this._isValid=false;if(d>1){return}var f=e*d;this._scrollHeight=e-f;this._scrollUnit=a-e-g*2;b.setHeight(f);this._isValid=true},_scrollThumb:function(i){var a=this._thumbNode,e=a.getHeight();var c=this._trackNode,j=this._wrapHeight,o=c.getPositionGlobalY(),m=j*0.5;var f=this._targetNode;var n=this._scrollHeight,k=this._scrollUnit;var d=this._scrollMin=m-n*0.5,h=this._scrollMax=m+n*0.5;var g=Math.max(d,Math.min(i-o,h));var b=this._scrollPos=g-e*0.5,l=-(g-d)/(h-d)*k;a.setPositionY(b);f.setPositionY(l)},_onThumbDragStart:function(){if(!this._isValid||this._isDisabled){return}var f=ControlKit.DocumentEventType.MOUSE_MOVE,a=ControlKit.DocumentEventType.MOUSE_UP;var c=this;var e=ControlKit.Mouse.getInstance();this._scrollOffset=e.getY()-this._thumbNode.getPositionGlobalY();var d=function(){c._scrollThumb(e.getY())},b=function(){document.removeEventListener(f,d,false);document.removeEventListener(a,b,false)};this._scrollThumb(e.getY());document.addEventListener(f,d,false);document.addEventListener(a,b,false)},enable:function(){this._isDisabled=false;this._updateAppearance()},disable:function(){this._isDisabled=true;this._updateAppearance()},reset:function(){this._scrollThumb(0)},_updateAppearance:function(){if(this._isDisabled){this._node.setStyleProperty("display","none");this._targetNode.setPositionY(0);this._thumbNode.setPositionY(ControlKit.Metric.SCROLLBAR_TRACK_PADDING)}else{this._node.setStyleProperty("display","block")}},isValid:function(){return this._isValid},setWrapHeight:function(a){this._wrapHeight=a;this.update()},removeTargetNode:function(){return this._wrapNode.removeChild(this._targetNode)},removeFromParent:function(){var a=this._parentNode,b=this._node,c=this._targetNode;b.removeChild(c);a.removeChild(this._wrapNode);a.removeChild(b);return c},getWrapNode:function(){return this._wrapNode},getNode:function(){return this._node},getTargetNode:function(){return this._targetNode}};ControlKit.AbstractGroup=function(a,b){ControlKit.EventDispatcher.apply(this,arguments);b=b||{};b.height=b.height||null;b.enable=b.enable===undefined?true:b.enable;this._parent=a;this._height=b.height;this._isDisabled=!b.enable;this._scrollBar=null;this._node=new ControlKit.Node(ControlKit.NodeType.LIST_ITEM);this._wrapNode=new ControlKit.Node(ControlKit.NodeType.DIV);this._listNode=new ControlKit.Node(ControlKit.NodeType.LIST);this._parent.getList().addChild(this._node)};ControlKit.AbstractGroup.prototype=Object.create(ControlKit.EventDispatcher.prototype);ControlKit.AbstractGroup.prototype.addScrollWrap=function(){var a=this._wrapNode,b=this.getMaxHeight();this._scrollBar=new ControlKit.ScrollBar(a,this._listNode,b);if(this.isEnabled()){a.setHeight(b)}};ControlKit.AbstractGroup.prototype.preventSelectDrag=function(){this._parent.preventSelectDrag();if(!this.hasScrollWrap()){return}this._wrapNode.getElement().scrollTop=0};ControlKit.AbstractGroup.prototype.hasMaxHeight=function(){return this._height!=null};ControlKit.AbstractGroup.prototype.getMaxHeight=function(){return this._height};ControlKit.AbstractGroup.prototype.hasScrollWrap=function(){return this._scrollBar!=null};ControlKit.AbstractGroup.prototype.hasLabel=function(){return this._lablNode!=null};ControlKit.AbstractGroup.prototype.disable=function(){this._isDisabled=false;this._updateAppearance()};ControlKit.AbstractGroup.prototype.enable=function(){this._isDisabled=true;this._updateAppearance()};ControlKit.AbstractGroup.prototype.isDisabled=function(){return this._isDisabled};ControlKit.AbstractGroup.prototype.isEnabled=function(){return !this._isDisabled};ControlKit.AbstractGroup.prototype.getList=function(){return this._listNode};ControlKit.Group=function(k,d){ControlKit.AbstractGroup.apply(this,arguments);d=d||{};d.label=d.label||null;d.useLabels=d.useLabels||true;d.enable=d.enable===undefined?true:d.enable;this._components=[];this._subGroups=[];var b=this._node,c=this._wrapNode,e=this._listNode;b.setStyleClass(ControlKit.CSS.Group);c.setStyleClass(ControlKit.CSS.Wrap);e.setStyleClass(ControlKit.CSS.SubGroupList);c.addChild(e);var j=d.label;if(j){var i=new ControlKit.Node(ControlKit.NodeType.DIV),g=new ControlKit.Node(ControlKit.NodeType.DIV),h=new ControlKit.Node(ControlKit.NodeType.SPAN),a=this._indiNode=new ControlKit.Node(ControlKit.NodeType.DIV);i.setStyleClass(ControlKit.CSS.Head);g.setStyleClass(ControlKit.CSS.Wrap);h.setStyleClass(ControlKit.CSS.Label);a.setStyleClass(ControlKit.CSS.ArrowBMax);h.setProperty("innerHTML",j);i.addChild(a);g.addChild(h);i.addChild(g);b.addChild(i);i.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onHeadTrigger.bind(this));this.addEventListener(ControlKit.EventType.GROUP_LIST_SIZE_CHANGE,this._parent,"onGroupListSizeChange");this._updateAppearance()}if(this.hasMaxHeight()){this.addScrollWrap()}b.addChild(c);if(this.hasMaxHeight()){if(!j){var f=this._scrollBufferTop=new ControlKit.Node(ControlKit.NodeType.DIV);f.setStyleClass(ControlKit.CSS.ScrollBuffer);b.addChildAt(f,0)}var l=this._scrollBufferBottom=new ControlKit.Node(ControlKit.NodeType.DIV);l.setStyleClass(ControlKit.CSS.ScrollBuffer);b.addChild(l)}this._parent.addEventListener(ControlKit.EventType.PANEL_MOVE_BEGIN,this,"onPanelMoveBegin");this._parent.addEventListener(ControlKit.EventType.PANEL_MOVE,this,"onPanelMove");this._parent.addEventListener(ControlKit.EventType.PANEL_MOVE_END,this,"onPanelMoveEnd");this._parent.addEventListener(ControlKit.EventType.PANEL_HIDE,this,"onPanelHide");this._parent.addEventListener(ControlKit.EventType.PANEL_SHOW,this,"onPanelShow");this._parent.addEventListener(ControlKit.EventType.PANEL_SCROLL_WRAP_ADDED,this,"onPanelScrollWrapAdded");this._parent.addEventListener(ControlKit.EventType.PANEL_SCROLL_WRAP_REMOVED,this,"onPanelScrollWrapRemoved");this._parent.addEventListener(ControlKit.EventType.PANEL_SIZE_CHANGE,this,"onPanelSizeChange");this.addEventListener(ControlKit.EventType.GROUP_SIZE_CHANGE,this._parent,"onGroupListSizeChange")};ControlKit.Group.prototype=Object.create(ControlKit.AbstractGroup.prototype);ControlKit.Group.prototype.onPanelMoveBegin=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_MOVE_BEGIN,null))};ControlKit.Group.prototype.onPanelMove=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_MOVE,null))};ControlKit.Group.prototype.onPanelMoveEnd=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_MOVE_END,null))};ControlKit.Group.prototype.onPanelScrollWrapAdded=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_SIZE_CHANGE,null))};ControlKit.Group.prototype.onPanelScrollWrapRemoved=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_SIZE_CHANGE,null))};ControlKit.Group.prototype.onPanelHide=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.SUBGROUP_DISABLE,null))};ControlKit.Group.prototype.onPanelShow=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.SUBGROUP_ENABLE,null))};ControlKit.Group.prototype.onPanelSizeChange=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_SIZE_CHANGE,null))};ControlKit.Group.prototype.onSubGroupTrigger=function(){this._updateHeight();if(!this.hasMaxHeight()){return}var d=this._scrollBar,a=this._wrapNode;var c=this._scrollBufferTop,b=this._scrollBufferBottom;d.update();if(!d.isValid()){d.disable();a.setHeight(a.getChildAt(1).getHeight());if(c){c.setStyleProperty("display","none")}if(b){b.setStyleProperty("display","none")}}else{d.enable();a.setHeight(this.getMaxHeight());if(c){c.setStyleProperty("display","block")}if(b){b.setStyleProperty("display","block")}}this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_SIZE_CHANGE,null))};ControlKit.Group.prototype._onHeadTrigger=function(){this._isDisabled=!this._isDisabled;this._updateAppearance();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_LIST_SIZE_CHANGE,null))};ControlKit.Group.prototype.addStringInput=function(a,b,c){return this._addComponent(new ControlKit.StringInput(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addNumberInput=function(a,b,c){return this._addComponent(new ControlKit.NumberInput(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addRange=function(a,b,c){return this._addComponent(new ControlKit.Range(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addCheckbox=function(a,b,c){return this._addComponent(new ControlKit.Checkbox(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addColor=function(a,b,c){return this._addComponent(new ControlKit.Color(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addButton=function(a,c,b){return this._addComponent(new ControlKit.Button(this.getSubGroup(),a,c,b))};ControlKit.Group.prototype.addSelect=function(a,b,c){return this._addComponent(new ControlKit.Select(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addSlider=function(b,c,a,d){return this._addComponent(new ControlKit.Slider(this.getSubGroup(),b,c,a,d))};ControlKit.Group.prototype.addFunctionPlotter=function(a,b,c){return this._addComponent(new ControlKit.FunctionPlotter(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addPad=function(a,b,c){return this._addComponent(new ControlKit.Pad(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addValuePlotter=function(a,b,c){return this._addComponent(new ControlKit.ValuePlotter(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addNumberOutput=function(a,b,c){return this._addComponent(new ControlKit.NumberOutput(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addStringOutput=function(a,b,c){return this._addComponent(new ControlKit.StringOutput(this.getSubGroup(),a,b,c))};ControlKit.Group.prototype.addCanvas=function(a){return this._addComponent(new ControlKit.Canvas(this.getSubGroup(),a))};ControlKit.Group.prototype.addSVG=function(a){return this._addComponent(new ControlKit.SVG(this.getSubGroup(),a))};ControlKit.Group.prototype._addComponent=function(a){this._components.push(a);this._updateHeight();return this};ControlKit.Group.prototype._updateHeight=function(){this.getSubGroup().update();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_SIZE_CHANGE,null));if(this.hasMaxHeight()){this._scrollBar.update()}};ControlKit.Group.prototype._updateAppearance=function(){var a=this._wrapNode,c=this._indiNode;var g=this._scrollBar;var e=this._scrollBufferTop,b=this._scrollBufferBottom;if(this.isDisabled()){a.setHeight(0);if(c){c.setStyleClass(ControlKit.CSS.ArrowBMin)}if(g){if(e){e.setStyleProperty("display","none")}if(b){b.setStyleProperty("display","none")}}return}if(this.hasMaxHeight()){var f=this.getMaxHeight(),d=a.getChildAt(1).getHeight();a.setHeight(d<f?d:f);if(g.isValid()){if(e){e.setStyleProperty("display","block")}if(b){b.setStyleProperty("display","block")}}}else{a.deleteStyleProperty("height")}if(c){c.setStyleClass(ControlKit.CSS.ArrowBMax)}};ControlKit.Group.prototype.onGroupSizeUpdate=function(){this._updateAppearance();if(this.hasMaxHeight()){this._scrollBar.update()}};ControlKit.Group.prototype.addSubGroup=function(a){this._subGroups.push(new ControlKit.SubGroup(this,a));this._updateHeight();return this};ControlKit.Group.prototype.getSubGroup=function(){var a=this._subGroups,b=a.length;if(b==0){this.addSubGroup(null)}return a[b-1]};ControlKit.Group.prototype.getComponents=function(){return this._components};ControlKit.SubGroup=function(j,d){ControlKit.AbstractGroup.apply(this,arguments);d=d||{};d.label=d.label||null;d.useLabels=d.useLabels===undefined?true:d.useLabels;var b=this._node,c=this._wrapNode,e=this._listNode;b.setStyleClass(ControlKit.CSS.SubGroup);c.setStyleClass(ControlKit.CSS.Wrap);c.addChild(e);b.addChild(c);this._useLabels=d.useLabels;var i=d.label;if(i){if(i.length!=0&&i!="none"){var h=this._headNode=new ControlKit.Node(ControlKit.NodeType.DIV),f=new ControlKit.Node(ControlKit.NodeType.DIV),g=new ControlKit.Node(ControlKit.NodeType.SPAN);h.setStyleClass(ControlKit.CSS.Head);f.setStyleClass(ControlKit.CSS.Wrap);g.setStyleClass(ControlKit.CSS.Label);g.setProperty("innerHTML",i);f.addChild(g);h.addChild(f);var a=this._indiNode=new ControlKit.Node(ControlKit.NodeType.DIV);a.setStyleClass(ControlKit.CSS.ArrowBSubMax);h.addChildAt(a,0);b.addChildAt(h,0);this.addEventListener(ControlKit.EventType.SUBGROUP_TRIGGER,this._parent,"onSubGroupTrigger");h.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onHeadMouseDown.bind(this));this._updateAppearance()}}if(this.hasMaxHeight()){this.addScrollWrap()}this._parent.addEventListener(ControlKit.EventType.SUBGROUP_ENABLE,this,"onEnable");this._parent.addEventListener(ControlKit.EventType.SUBGROUP_DISABLE,this,"onDisable");this._parent.addEventListener(ControlKit.EventType.PANEL_MOVE_END,this,"onPanelMoveEnd");this._parent.addEventListener(ControlKit.EventType.GROUP_SIZE_CHANGE,this,"onGroupSizeChange");this._parent.addEventListener(ControlKit.EventType.PANEL_SIZE_CHANGE,this,"onPanelSizeChange");this.addEventListener(ControlKit.EventType.GROUP_SIZE_UPDATE,this._parent,"onGroupSizeUpdate")};ControlKit.SubGroup.prototype=Object.create(ControlKit.AbstractGroup.prototype);ControlKit.SubGroup.prototype._onHeadMouseDown=function(){this._isDisabled=!this._isDisabled;this._onTrigger();var c=ControlKit.DocumentEventType.MOUSE_UP,a=this;var b=function(){a._onTrigger();document.removeEventListener(c,b)};document.addEventListener(c,b)};ControlKit.SubGroup.prototype._onTrigger=function(){this._updateAppearance();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.SUBGROUP_TRIGGER,null))};ControlKit.SubGroup.prototype._updateAppearance=function(){if(this.isDisabled()){this._wrapNode.setHeight(0);if(this.hasLabel()){this._headNode.setStyleClass(ControlKit.CSS.HeadInactive);this._indiNode.setStyleClass(ControlKit.CSS.ArrowBSubMin)}}else{if(this.hasMaxHeight()){this._wrapNode.setHeight(this.getMaxHeight())}else{this._wrapNode.deleteStyleProperty("height")}if(this.hasLabel()){this._headNode.setStyleClass(ControlKit.CSS.Head);this._indiNode.setStyleClass(ControlKit.CSS.ArrowBSubMax)}}};ControlKit.SubGroup.prototype.update=function(){if(this.hasMaxHeight()){this._scrollBar.update()}};ControlKit.SubGroup.prototype.onComponentSelectDrag=function(){this.preventSelectDrag()};ControlKit.SubGroup.prototype.onEnable=function(){if(this.isDisabled()){return}this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.COMPONENTS_ENABLE,null))};ControlKit.SubGroup.prototype.onDisable=function(){if(this.isDisabled()){return}this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.COMPONENTS_DISABLE,null))};ControlKit.SubGroup.prototype.onGroupSizeChange=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_SIZE_CHANGE,null))};ControlKit.SubGroup.prototype.onGroupSizeUpdate=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_SIZE_UPDATE,null))};ControlKit.SubGroup.prototype.onPanelMoveEnd=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_MOVE_END,null))};ControlKit.SubGroup.prototype.onPanelSizeChange=function(){this._updateAppearance()};ControlKit.SubGroup.prototype.hasLabel=function(){return this._headNode!=null};ControlKit.SubGroup.prototype.addComponentNode=function(a){this._listNode.addChild(a)};ControlKit.SubGroup.prototype.usesLabels=function(){return this._useLabels};ControlKit.Panel=function(j,p){ControlKit.EventDispatcher.apply(this,arguments);this._parent=j;p=p||{};p.valign=p.valign||ControlKit.Default.PANEL_VALIGN;p.align=p.align||ControlKit.Default.PANEL_ALIGN;p.position=p.position||ControlKit.Default.PANEL_POSITION;p.width=p.width||ControlKit.Default.PANEL_WIDTH;p.height=p.height||ControlKit.Default.PANEL_HEIGHT;p.ratio=p.ratio||ControlKit.Default.PANEL_RATIO;p.label=p.label||ControlKit.Default.PANEL_LABEL;p.opacity=p.opacity||ControlKit.Default.PANEL_OPACITY;p.fixed=p.fixed===undefined?ControlKit.Default.PANEL_FIXED:p.fixed;p.enable=p.enable===undefined?ControlKit.Default.PANEL_ENABLE:p.enable;p.vconstrain=p.vconstrain===undefined?ControlKit.Default.PANEL_VCONSTRAIN:p.vconstrain;if(p.dock){p.dock.align=p.dock.align||ControlKit.Default.PANEL_DOCK.align;p.dock.resizable=p.dock.resizable||ControlKit.Default.PANEL_DOCK.resizable}this._width=Math.max(ControlKit.Default.PANEL_WIDTH_MIN,Math.min(p.width,ControlKit.Default.PANEL_WIDTH_MAX));this._height=p.height?Math.max(0,Math.min(p.height,window.innerHeight)):null;this._fixed=p.fixed;this._dock=p.dock;this._position=p.position;this._vConstrain=p.vconstrain;this._label=p.label;this._isDisabled=!p.enable;this._groups=[];var k=this._width,f=this._fixed,l=this._dock,v=this._position,g=this._label,m=p.align,c=p.opacity;var q=this._node=new ControlKit.Node(ControlKit.NodeType.DIV),o=this._headNode=new ControlKit.Node(ControlKit.NodeType.DIV),a=new ControlKit.Node(ControlKit.NodeType.DIV),s=new ControlKit.Node(ControlKit.NodeType.DIV),b=new ControlKit.Node(ControlKit.NodeType.SPAN),h=this._wrapNode=new ControlKit.Node(ControlKit.NodeType.DIV),d=this._listNode=new ControlKit.Node(ControlKit.NodeType.LIST);q.setStyleClass(ControlKit.CSS.Panel);o.setStyleClass(ControlKit.CSS.Head);a.setStyleClass(ControlKit.CSS.Menu);s.setStyleClass(ControlKit.CSS.Wrap);b.setStyleClass(ControlKit.CSS.Label);h.setStyleClass(ControlKit.CSS.Wrap);d.setStyleClass(ControlKit.CSS.GroupList);q.setWidth(k);b.setProperty("innerHTML",g);o.addChild(a);s.addChild(b);o.addChild(s);h.addChild(d);q.addChild(o);q.addChild(h);j.getNode().addChild(q);if(!l){var u=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON),n=this._menuHide=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON);u.setStyleClass(ControlKit.CSS.MenuBtnClose);n.setStyleClass(ControlKit.CSS.MenuBtnHide);a.addChild(n);a.addChild(u);n.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onMenuHideMouseDown.bind(this));u.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this.disable.bind(this));if(this.hasMaxHeight()){this._addScrollWrap()}if(!f){if(v){if(m==ControlKit.LayoutMode.LEFT||m==ControlKit.LayoutMode.TOP||m==ControlKit.LayoutMode.BOTTOM){q.setPositionGlobal(v[0],v[1])}else{q.setPositionGlobal(window.innerWidth-k-v[0],v[1]);this._position=q.getPosition()}}else{this._position=q.getPosition()}this._mouseOffset=[0,0];q.setStyleProperty("position","absolute");o.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onHeadDragStart.bind(this))}else{if(v){var t=v[0],r=v[1];if(r!=0){q.setPositionY(r)}if(t!=0){if(m==ControlKit.LayoutMode.RIGHT){q.getElement().marginRight=t}else{q.setPositionX(t)}}}q.setStyleProperty("float",m)}}else{var i=l.align;if(i==ControlKit.LayoutMode.LEFT||i==ControlKit.LayoutMode.RIGHT){m=i;this._height=window.innerHeight}if(i==ControlKit.LayoutMode.TOP||i==ControlKit.LayoutMode.BOTTOM){}q.setStyleProperty("float",m)}if(this._parent.historyIsEnabled()){var e=this._menuUndo=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON);e.setStyleClass(ControlKit.CSS.MenuBtnUndo);e.setStyleProperty("display","none");e.setProperty("value",ControlKit.History.getInstance().getNumStates());a.addChildAt(e,0);e.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onMenuUndoTrigger.bind(this));o.addEventListener(ControlKit.NodeEventType.MOUSE_OVER,this._onHeadMouseOver.bind(this));o.addEventListener(ControlKit.NodeEventType.MOUSE_OUT,this._onHeadMouseOut.bind(this))}if(c!=1&&c!=0){q.setStyleProperty("opacity",c)}this._parent.addEventListener(ControlKit.EventType.UPDATE_MENU,this,"onUpdateMenu");window.addEventListener(ControlKit.DocumentEventType.WINDOW_RESIZE,this._onWindowResize.bind(this))};ControlKit.Panel.prototype=Object.create(ControlKit.EventDispatcher.prototype);ControlKit.Panel.prototype.addGroup=function(b){var a=new ControlKit.Group(this,b);this._groups.push(a);if(this.isDocked()){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_SIZE_CHANGE))}return a};ControlKit.Panel.prototype._onMenuHideMouseDown=function(){this._isDisabled=!this._isDisabled;this._updateAppearance()};ControlKit.Panel.prototype._updateAppearance=function(){var a=this._node,c=this._headNode,b=this._menuHide;if(this._isDisabled){c.getStyle().borderBottom="none";a.setHeight(c.getHeight());b.setStyleClass(ControlKit.CSS.MenuBtnShow);this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_HIDE,null))}else{a.setHeight(c.getHeight()+this._wrapNode.getHeight());a.deleteStyleProperty("height");b.setStyleClass(ControlKit.CSS.MenuBtnHide);c.setStyleClass(ControlKit.CSS.Head);this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_SHOW,null))}};ControlKit.Panel.prototype._onHeadMouseOver=function(){this._menuUndo.setStyleProperty("display","inline")};ControlKit.Panel.prototype._onHeadMouseOut=function(){this._menuUndo.setStyleProperty("display","none")};ControlKit.Panel.prototype.onUpdateMenu=function(){this._menuUndo.setProperty("value",ControlKit.History.getInstance().getNumStates())};ControlKit.Panel.prototype._onMenuUndoTrigger=function(){ControlKit.History.getInstance().popState()};ControlKit.Panel.prototype._onHeadDragStart=function(){var h=this._parent.getNode(),e=this._node;var g=e.getPositionGlobal(),i=ControlKit.Mouse.getInstance().getPosition(),b=this._mouseOffset;b[0]=i[0]-g[0];b[1]=i[1]-g[1];var d=ControlKit.DocumentEventType.MOUSE_MOVE,a=ControlKit.DocumentEventType.MOUSE_UP;var j=this;var f=function(){j._updatePosition()},c=function(){document.removeEventListener(d,f,false);document.removeEventListener(a,c,false);j.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_MOVE_END,null))};h.removeChild(e);h.addChild(e);document.addEventListener(d,f,false);document.addEventListener(a,c,false);this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_MOVE_BEGIN,null))};ControlKit.Panel.prototype._updatePosition=function(){var b=ControlKit.Mouse.getInstance().getPosition(),c=this._mouseOffset;var a=this._position;a[0]=b[0]-c[0];a[1]=b[1]-c[1];this._constrainHeight();this._constrainPosition();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_MOVE,null))};ControlKit.Panel.prototype._onWindowResize=function(){if(this.isDocked()){var b=this._dock;if(b.align==ControlKit.LayoutMode.RIGHT||b.align==ControlKit.LayoutMode.LEFT){var d=window.innerHeight,a=this._listNode.getHeight(),c=this._headNode.getHeight();this._height=d;if((d-c)>a){this._scrollBar.disable()}else{this._scrollBar.enable()}this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_SIZE_CHANGE))}}else{if(!this.isFixed()){this._constrainPosition()}}this._constrainHeight()};ControlKit.Panel.prototype._constrainPosition=function(){var b=this._node;var d=window.innerWidth-b.getWidth(),c=window.innerHeight-b.getHeight();var a=this._position;a[0]=Math.max(0,Math.min(a[0],d));a[1]=Math.max(0,Math.min(a[1],c));b.setPositionGlobal(a[0],a[1])};ControlKit.Panel.prototype._constrainHeight=function(){if(!this._vConstrain){return}var c=this.hasMaxHeight(),i=this.hasScrollWrap();var k=this._headNode,e=this._wrapNode;var b=this._scrollBar;var d=this.isDocked()?0:this.isFixed()?0:this._position[1];var h=c?this.getMaxHeight():i?b.getTargetNode().getHeight():e.getHeight();var l=d+h;var f=k.getHeight();var a=window.innerHeight,g=a-l-f,j;if(g<0){j=h+g;if(!i){this._addScrollWrap(j);this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_SCROLL_WRAP_ADDED,null));return}b.setWrapHeight(j);e.setHeight(j)}else{if(!c&&i){b.removeFromParent();e.addChild(this._listNode);e.deleteStyleProperty("height");this._scrollBar=null;this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.PANEL_SCROLL_WRAP_REMOVED,null))}}};ControlKit.Panel.prototype.onGroupListSizeChange=function(){if(this.hasScrollWrap()){this._updateScrollWrap()}this._constrainHeight()};ControlKit.Panel.prototype._updateScrollWrap=function(){var b=this._wrapNode,d=this._scrollBar,a=this.hasMaxHeight()?this.getMaxHeight():100,c=this._listNode.getHeight();b.setHeight(c<a?c:a);d.update();if(!d.isValid()){d.disable();b.setHeight(b.getChildAt(1).getHeight())}else{d.enable();b.setHeight(a)}};ControlKit.Panel.prototype._addScrollWrap=function(){var b=this._wrapNode,c=this._listNode,a=arguments.length==0?this.getMaxHeight():arguments[0];this._scrollBar=new ControlKit.ScrollBar(b,c,a);if(this.isEnabled()){b.setHeight(a)}};ControlKit.Panel.prototype.hasScrollWrap=function(){return this._scrollBar!=null};ControlKit.Panel.prototype.preventSelectDrag=function(){if(!this.hasScrollWrap()){return}this._wrapNode.getElement().scrollTop=0};ControlKit.Panel.prototype.enable=function(){this._node.setStyleProperty("display","block");this._isDisabled=false;this._updateAppearance()};ControlKit.Panel.prototype.disable=function(){this._node.setStyleProperty("display","none");this._isDisabled=true;this._updateAppearance()};ControlKit.Panel.prototype.isEnabled=function(){return !this._isDisabled};ControlKit.Panel.prototype.isDisabled=function(){return this._isDisabled};ControlKit.Panel.prototype.hasMaxHeight=function(){return this._height!=null};ControlKit.Panel.prototype.getMaxHeight=function(){return this._height};ControlKit.Panel.prototype.isDocked=function(){return this._dock};ControlKit.Panel.prototype.isFixed=function(){return this._fixed};ControlKit.Panel.prototype.getGroups=function(){return this._groups};ControlKit.Panel.prototype.getNode=function(){return this._node};ControlKit.Panel.prototype.getList=function(){return this._listNode};ControlKit.Panel.prototype.getWidth=function(){return this._width};ControlKit.Panel.prototype.getPosition=function(){return this._position};ControlKit.Options=function(a){this._parenNode=a;var c=this._node=new ControlKit.Node(ControlKit.NodeType.DIV);var b=this._listNode=new ControlKit.Node(ControlKit.NodeType.LIST);c.setStyleClass(ControlKit.CSS.Options);c.addChild(b);this._selectedIndex=null;this._callbackOut=function(){};this._unfocusable=false;document.addEventListener(ControlKit.DocumentEventType.MOUSE_DOWN,this._onDocumentMouseDown.bind(this));document.addEventListener(ControlKit.DocumentEventType.MOUSE_UP,this._onDocumentMouseUp.bind(this));this.clear()};ControlKit.Options.prototype={_onDocumentMouseDown:function(){if(!this._unfocusable){return}this._callbackOut()},_onDocumentMouseUp:function(){this._unfocusable=true},build:function(n,v,d,b,f,a,C,h){this._clearList();this._parenNode.addChild(this.getNode());var B=this._node,g=this._listNode;a=a||0;var s=this;var m,c;var z=-1;if(C){h=h||ControlKit.ColorMode.HEX;g.setStyleClass(ControlKit.CSS.Color);var x,e;while(++z<n.length){c=n[z];m=g.addChild(new ControlKit.Node(ControlKit.NodeType.LIST_ITEM));x=m.addChild(new ControlKit.Node(ControlKit.NodeType.DIV));switch(h){case ControlKit.ColorMode.HEX:e=c;break;case ControlKit.ColorMode.RGB:e=ControlKit.ColorUtil.RGB2HEX(c[0],c[1],c[2]);break;case ControlKit.ColorMode.RGBfv:e=ControlKit.ColorUtil.RGBfv2HEX(c[0],c[1],c[2]);break;case ControlKit.ColorMode.HSV:e=ControlKit.ColorUtil.HSV2RGB(c[0],c[1],c[2]);break}x.getStyle().backgroundColor=e;x.getStyle().backgroundImage="linear-gradient( rgba(0,0,0,0) 0%, rgba(0,0,0,0.1) 100%)";x.setProperty("innerHTML",c);if(c==v){m.setStyleClass(ControlKit.CSS.OptionsSelected)}m.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,function(){s._selectedIndex=Array.prototype.indexOf.call(this.parentNode.children,this);b()})}}else{g.deleteStyleClass();while(++z<n.length){c=n[z];m=g.addChild(new ControlKit.Node(ControlKit.NodeType.LIST_ITEM));m.setProperty("innerHTML",c);if(c==v){m.setStyleClass(ControlKit.CSS.OptionsSelected)}m.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,function(){s._selectedIndex=Array.prototype.indexOf.call(this.parentNode.children,this);b()})}}var y=d.getPositionGlobal(),A=d.getWidth()-a,r=d.getHeight();var t=g.getWidth(),u=g.getHeight(),q=ControlKit.Metric.STROKE_SIZE*2;var E=ControlKit.Metric.PADDING_OPTIONS;var w=(t<A?A:t)-q,k=y[0],j=y[1]+r-E;var D=window.innerWidth,l=window.innerHeight;var p=(k+w)>D?(k-w+A-q):k,o=(j+u)>l?(j-u*0.5-r*0.5):j;g.setWidth(w);B.setPositionGlobal(p,o);this._callbackOut=f;this._unfocusable=false},_clearList:function(){this._listNode.removeAllChildren();this._listNode.deleteStyleProperty("width");this._selectedIndex=null;this._build=false},clear:function(){this._clearList();this._callbackOut=function(){};this._parenNode.removeChild(this.getNode())},isBuild:function(){return this._build},getNode:function(){return this._node},getSelectedIndex:function(){return this._selectedIndex}};ControlKit.Options.init=function(a){return ControlKit.Options._instance=new ControlKit.Options(a)};ControlKit.Options.getInstance=function(){return ControlKit.Options._instance};ControlKit.NumberInput_Internal=function(a,d,f,c,e){ControlKit.EventDispatcher.apply(this,null);this._value=0;this._valueStep=a||1;this._valueDPlace=d+1;this._onBegin=f||function(){};this._onChange=c||function(){};this._onFinish=e||function(){};this._prevKeyCode=null;var b=this._input=new ControlKit.Node(ControlKit.NodeType.INPUT_TEXT);b.setProperty("value",this._value);b.addEventListener(ControlKit.NodeEventType.KEY_DOWN,this._onInputKeyDown.bind(this));b.addEventListener(ControlKit.NodeEventType.KEY_UP,this._onInputKeyUp.bind(this));b.addEventListener(ControlKit.NodeEventType.CHANGE,this._onInputChange.bind(this))};ControlKit.NumberInput_Internal.prototype=Object.create(ControlKit.EventDispatcher.prototype);ControlKit.NumberInput_Internal.prototype._onInputKeyDown=function(c){var a=(c.shiftKey?ControlKit.Preset.NUMBER_INPUT_SHIFT_MULTIPLIER:1)*this._valueStep,b=c.keyCode;if(b==38||b==40){c.preventDefault();var d=b==38?1:-1;this._value+=(a*d);this._onBegin();this._onChange();this._format()}};ControlKit.NumberInput_Internal.prototype._onInputKeyUp=function(b){var a=b.keyCode;if(b.shiftKey||a==38||a==40||a==190||a==8||a==39||a==37||a==189){this._prevKeyCode=a;return}if(this._prevKeyCode==189&&a==48){return}if(this._prevKeyCode==190&&a==48){return}this._validate();this._format()};ControlKit.NumberInput_Internal.prototype._onInputChange=function(a){this._validate();this._format();this._onFinish()};ControlKit.NumberInput_Internal.prototype._validate=function(){if(this.inputIsNumber()){var a=this._getInput();if(a!="-"){this._value=Number(a)}this._onChange();return}this._setOutput(this._value)};ControlKit.NumberInput_Internal.prototype.inputIsNumber=function(){var a=this._getInput();if(a=="-"||a=="0"){return true}return/^\s*-?[0-9]\d*(\.\d{1,1000000})?\s*$/.test(a)};ControlKit.NumberInput_Internal.prototype._format=function(){var b=this._value.toString(),a=b.indexOf(".");if(a>0){b=b.slice(0,a+this._valueDPlace)}this._setOutput(b)};ControlKit.NumberInput_Internal.prototype._setOutput=function(a){this._input.setProperty("value",a)};ControlKit.NumberInput_Internal.prototype._getInput=function(){return this._input.getProperty("value")};ControlKit.NumberInput_Internal.prototype.getValue=function(){return this._value};ControlKit.NumberInput_Internal.prototype.setValue=function(a){this._value=a;this._format()};ControlKit.NumberInput_Internal.prototype.getNode=function(){return this._input};ControlKit.Slider_Internal=function(b,f,c,e){this._bounds=[0,1];this._value=0;this._interpl=0;this._focus=false;this._onBegin=f||function(){};this._onChange=c||function(){};this._onFinish=e||function(){};var a=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.SliderWrap);b.addChild(a);var g=this._slot={node:new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.SliderSlot),offsetX:0,width:0,padding:3};var d=this._handle={node:new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.SliderHandle),width:0,dragging:false};a.addChild(g.node);g.node.addChild(d.node);g.offsetX=g.node.getPositionGlobalX();g.width=Math.floor(g.node.getWidth()-g.padding*2);d.node.setWidth(d.width);g.node.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onSlotMouseDown.bind(this));g.node.addEventListener(ControlKit.NodeEventType.MOUSE_UP,this._onSlotMouseUp.bind(this));document.addEventListener(ControlKit.DocumentEventType.MOUSE_MOVE,this._onDocumentMouseMove.bind(this));document.addEventListener(ControlKit.DocumentEventType.MOUSE_UP,this._onDocumentMouseUp.bind(this))};ControlKit.Slider_Internal.prototype={_onDocumentMouseMove:function(a){if(!this._handle.dragging){return}this._update();this._onChange()},_onDocumentMouseUp:function(a){if(this._handle.dragging){this._onFinish()}this._handle.dragging=false},_onSlotMouseDown:function(){this._onBegin();this._focus=true;this._handle.dragging=true;this._handle.node.getElement().focus();this._update()},_onSlotMouseUp:function(){if(this._focus){var a=this._handle;if(a.dragging){this._onFinish()}a.dragging=false}this._focus=false},_update:function(){var c=ControlKit.Mouse.getInstance().getX(),d=this._slot.offsetX,a=this._slot.width,b=(c<d)?0:(c>(d+a))?a:(c-d);this._handle.node.setWidth(Math.round(b));this._intrpl=b/a;this._interpolateValue()},_updateHandle:function(){var b=this._slot.width,a=Math.round(this._intrpl*b);this._handle.node.setWidth(Math.min(a,b))},_interpolateValue:function(){var a=this._intrpl;this._value=this._bounds[0]*(1-a)+this._bounds[1]*a},resetOffset:function(){var a=this._slot;a.offsetX=a.node.getPositionGlobalX();a.width=Math.floor(a.node.getWidth()-a.padding*2)},setBoundMin:function(b){var a=this._bounds;if(b>=a[1]){return}a[0]=b;this._interpolateValueRelative();this._updateHandle()},setBoundMax:function(b){var a=this._bounds;if(b<=a[0]){return}a[1]=b;this._interpolateValueRelative();this._updateHandle()},_interpolateValueRelative:function(){var b=this._bounds[0],a=this._bounds[1],c=Math.abs((this._value-b)/(b-a));this._value=b*(1-c)+a*c;this._intrpl=Math.abs((this._value-b)/(b-a))},setValue:function(c){var b=this._bounds[0],a=this._bounds[1];if(c<b||c>a){return}this._intrpl=Math.abs((c-b)/(b-a));this._updateHandle();this._value=c},getValue:function(){return this._value}};ControlKit.Plotter=function(d,b,e,h){ControlKit.SVGComponent.apply(this,arguments);h=h||{};h.lineWidth=h.lineWidth||2;h.lineColor=h.lineColor||[255,255,255];var a=this._lineWidth=h.lineWidth;var g=h.lineColor;var c=this._grid=this._svgRoot.appendChild(this._createSVGObject("path"));c.style.stroke="rgb(26,29,31)";var f=this._path=this._svgRoot.appendChild(this._createSVGObject("path"));f.style.stroke="rgb("+g[0]+","+g[1]+","+g[2]+")";f.style.strokeWidth=a;f.style.fill="none"};ControlKit.Plotter.prototype=Object.create(ControlKit.SVGComponent.prototype);ControlKit.PresetBtn=function(a){var b=this._btnNode=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON);var c=this._indiNode=new ControlKit.Node(ControlKit.NodeType.DIV);this._onActive=function(){};this._onDeactive=function(){};this._isActive=false;b.setStyleClass(ControlKit.CSS.PresetBtn);b.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onMouseDown.bind(this));b.addChild(c);a.addChildAt(b,0)};ControlKit.PresetBtn.prototype={_onMouseDown:function(){var a=this._isActive=!this._isActive;if(a){this._btnNode.setStyleClass(ControlKit.CSS.PresetBtnActive);this._onActive()}else{this._btnNode.setStyleClass(ControlKit.CSS.PresetBtn);this._onDeactive()}},setOnActive:function(a){this._onActive=a},setOnDeactive:function(a){this._onDeactive=a},deactivate:function(){this._active=false;this._btnNode.setStyleClass(ControlKit.CSS.PresetBtn)}};ControlKit.Output=function(i,f,h,e){ControlKit.ObjectComponent.apply(this,arguments);e=e||{};e.height=e.height||null;e.wrap=e.wrap||false;this._wrap=e.wrap;var b=this._textArea=new ControlKit.Node(ControlKit.NodeType.TEXTAREA),d=this._wrapNode,c=this._node;b.setProperty("readOnly",true);d.addChild(b);b.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onInputDragStart.bind(this));this.addEventListener(ControlKit.EventType.INPUT_SELECT_DRAG,this._parent,"onComponentSelectDrag");if(e.height){var a=new ControlKit.Node(ControlKit.NodeType.DIV);a.setStyleClass(ControlKit.CSS.TextAreaWrap);a.addChild(b);d.addChild(a);var j=this._height=e.height,g=4;b.setHeight(Math.max(j+g,ControlKit.Metric.COMPONENT_MIN_HEIGHT));d.setHeight(b.getHeight());c.setHeight(d.getHeight()+g);this._scrollBar=new ControlKit.ScrollBar(a,b,j-g)}if(e.wrap){b.setStyleProperty("white-space","pre-wrap")}this._prevString="";this._prevScrollHeight=-1;this._setValue()};ControlKit.Output.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.Output.prototype._setValue=function(){};ControlKit.Output.prototype.onValueUpdate=function(){this._setValue()};ControlKit.Output.prototype.update=function(){this._setValue()};ControlKit.Output.prototype._onInputDragStart=function(){var a=ControlKit.DocumentEventType.MOUSE_MOVE,f=ControlKit.DocumentEventType.MOUSE_UP;var e=ControlKit.EventType.INPUT_SELECT_DRAG;var c=this;var d=function(){c.dispatchEvent(new ControlKit.Event(this,e,null))},b=function(){c.dispatchEvent(new ControlKit.Event(this,e,null));document.removeEventListener(a,d,false);document.removeEventListener(a,b,false)};this.dispatchEvent(new ControlKit.Event(this,e,null));document.addEventListener(a,d,false);document.addEventListener(f,b,false)};ControlKit.FunctionPlotType={IMPLICIT:"implicit",NON_IMPLICIT:"nonImplicit"};ControlKit.StringInput=function(k,f,j,e){ControlKit.ObjectComponent.apply(this,arguments);e=e||{};e.onChange=e.onChange||this._onChange;e.onFinish=e.onFinish||this._onFinish;e.presets=e.presets||null;this._onChange=e.onChange;this._onFinish=e.onFinish;this._presetsKey=e.presets;var i=this._input=new ControlKit.Node(ControlKit.NodeType.INPUT_TEXT);var c=this._wrapNode;if(!this._presetsKey){c.addChild(i)}else{var h=new ControlKit.Node(ControlKit.NodeType.DIV);h.setStyleClass(ControlKit.CSS.WrapInputWPreset);c.addChild(h);h.addChild(i);var g=this._object[this._presetsKey],m=ControlKit.Options.getInstance(),b=new ControlKit.PresetBtn(this._wrapNode);var d=function(){m.clear();b.deactivate()};var l=this;var a=function(){m.build(g,i.getProperty("value"),i,function(){i.setProperty("value",g[m.getSelectedIndex()]);l.pushHistoryState();l.applyValue()},d,ControlKit.Metric.PADDING_PRESET,false)};b.setOnActive(a);b.setOnDeactive(d)}i.setProperty("value",this._object[this._key]);i.addEventListener(ControlKit.NodeEventType.KEY_UP,this._onInputKeyUp.bind(this));i.addEventListener(ControlKit.NodeEventType.CHANGE,this._onInputChange.bind(this));i.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onInputDragStart.bind(this));this.addEventListener(ControlKit.EventType.INPUT_SELECT_DRAG,this._parent,"onComponentSelectDrag")};ControlKit.StringInput.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.StringInput.prototype._onInputKeyUp=function(a){if(this._keyIsChar(a.keyCode)){this.pushHistoryState()}this.applyValue();this._onChange()};ControlKit.StringInput.prototype._onInputChange=function(a){if(this._keyIsChar(a.keyCode)){this.pushHistoryState()}this.applyValue();this._onFinish()};ControlKit.StringInput.prototype._keyIsChar=function(a){return a!=17&&a!=18&&a!=20&&a!=37&&a!=38&&a!=39&&a!=40&&a!=16};ControlKit.StringInput.prototype.applyValue=function(){this._object[this._key]=this._input.getProperty("value");this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null))};ControlKit.StringInput.prototype.onValueUpdate=function(a){if(a.data.origin==this){return}this._input.setProperty("value",this._object[this._key])};ControlKit.StringInput.prototype._onInputDragStart=function(){var a=ControlKit.DocumentEventType.MOUSE_MOVE,f=ControlKit.DocumentEventType.MOUSE_UP;var e=ControlKit.EventType.INPUT_SELECT_DRAG;var c=this;var d=function(){c.dispatchEvent(new ControlKit.Event(this,e,null))},b=function(){c.dispatchEvent(new ControlKit.Event(this,e,null));document.removeEventListener(a,d,false);document.removeEventListener(a,b,false)};this.dispatchEvent(new ControlKit.Event(this,e,null));document.addEventListener(a,d,false);document.addEventListener(f,b,false)};ControlKit.NumberInput=function(k,f,j,e){ControlKit.ObjectComponent.apply(this,arguments);e=e||{};e.onChange=e.onChange||this._onChange;e.onFinish=e.onFinish||this._onFinish;e.dp=e.dp||2;e.step=e.step||1;e.presets=e.presets||null;this._onChange=e.onChange;this._onFinish=e.onFinish;this._presetsKey=e.presets;var i=this._input=new ControlKit.NumberInput_Internal(e.step,e.dp,null,this._onInputChange.bind(this),this._onInputFinish.bind(this));var c=this._wrapNode;if(!this._presetsKey){c.addChild(i.getNode())}else{var h=new ControlKit.Node(ControlKit.NodeType.DIV);h.setStyleClass(ControlKit.CSS.WrapInputWPreset);c.addChild(h);h.addChild(i.getNode());var g=this._object[this._presetsKey];var m=ControlKit.Options.getInstance();var b=this._presetBtn=new ControlKit.PresetBtn(this._wrapNode);var d=function(){m.clear();b.deactivate()};var l=this;var a=function(){m.build(g,i.getValue(),i.getNode(),function(){i.setValue(g[m.getSelectedIndex()]);l.applyValue()},d,ControlKit.Metric.PADDING_PRESET,false)};b.setOnActive(a);b.setOnDeactive(d)}i.getNode().addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onInputDragStart.bind(this));this.addEventListener(ControlKit.EventType.INPUT_SELECT_DRAG,this._parent,"onComponentSelectDrag");i.setValue(this._object[this._key])};ControlKit.NumberInput.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.NumberInput.prototype._onInputChange=function(){this.applyValue();this._onChange()};ControlKit.NumberInput.prototype._onInputFinish=function(){this.applyValue();this._onFinish()};ControlKit.NumberInput.prototype.applyValue=function(){this.pushHistoryState();this._object[this._key]=this._input.getValue();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null))};ControlKit.NumberInput.prototype.onValueUpdate=function(a){if(a.data.origin==this){return}this._input.setValue(this._object[this._key])};ControlKit.NumberInput.prototype._onInputDragStart=function(){var a=ControlKit.DocumentEventType.MOUSE_MOVE,f=ControlKit.DocumentEventType.MOUSE_UP;var e=ControlKit.EventType.INPUT_SELECT_DRAG;var c=this;var d=function(){c.dispatchEvent(new ControlKit.Event(this,e,null))},b=function(){c.dispatchEvent(new ControlKit.Event(this,e,null));document.removeEventListener(a,d,false);document.removeEventListener(a,b,false)};this.dispatchEvent(new ControlKit.Event(this,e,null));document.addEventListener(a,d,false);document.addEventListener(f,b,false)};ControlKit.Button=function(c,b,e,d){d=d||{};d.label=d.label||"";ControlKit.Component.apply(this,[c,d.label]);var a=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON);e=e||function(){};a.setStyleClass(ControlKit.CSS.Button);a.setProperty("value",b);a.addEventListener(ControlKit.NodeEventType.ON_CLICK,function(){e();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED))}.bind(this));this._wrapNode.addChild(a)};ControlKit.Button.prototype=Object.create(ControlKit.Component.prototype);ControlKit.Range=function(n,g,m,f){ControlKit.ObjectComponent.apply(this,arguments);f=f||{};f.onChange=f.onChange||this._onChange;f.onFinish=f.onFinish||this._onFinish;f.step=f.step||1;f.dp=f.dp||2;this._onChange=f.onChange;this._onFinish=f.onFinish;var c=this._step=f.step,e=this._dp=f.dp;var l=new ControlKit.Node(ControlKit.NodeType.DIV);var d=this._inputMin=new ControlKit.NumberInput_Internal(c,e,this.pushHistoryState.bind(this),this._onInputMinChange.bind(this),this._onInputMinFinish.bind(this));var h=new ControlKit.Node(ControlKit.NodeType.DIV);var j=this._inputMax=new ControlKit.NumberInput_Internal(c,e,this.pushHistoryState.bind(this),this._onInputMaxChange.bind(this),this._onInputMaxFinish.bind(this));var a=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Wrap),k=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Wrap),i=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Wrap),p=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Wrap);l.setStyleClass(ControlKit.CSS.Label).setProperty("innerHTML","MIN");h.setStyleClass(ControlKit.CSS.Label).setProperty("innerHTML","MAX");var o=this._object[this._key];d.setValue(o[0]);j.setValue(o[1]);var b=this._wrapNode;a.addChild(l);k.addChild(d.getNode());i.addChild(h);p.addChild(j.getNode());b.addChild(a);b.addChild(k);b.addChild(i);b.addChild(p)};ControlKit.Range.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.Range.prototype._onInputChange=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null));this._onChange()};ControlKit.Range.prototype._onInputFinish=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null));this._onFinish()};ControlKit.Range.prototype._updateValueMin=function(){var b=this._object[this._key];var c=this._inputMin,a=c.getValue();if(a>=this._inputMax.getValue()){c.setValue(b[0]);return}b[0]=a};ControlKit.Range.prototype._updateValueMax=function(){var b=this._object[this._key];var c=this._inputMax,a=c.getValue();if(a<=this._inputMin.getValue()){c.setValue(b[1]);return}b[1]=a};ControlKit.Range.prototype.onValueUpdate=function(b){if(b.data.origin==this){return}if(b.data.origin==null){}var a=this._object[this._key];this._inputMin.setValue(this._object[this._key][0]);this._inputMax.setValue(this._object[this._key][1])};ControlKit.Range.prototype._onInputMinChange=function(){this._updateValueMin();this._onInputChange()};ControlKit.Range.prototype._onInputMinFinish=function(){this._updateValueMin();this._onInputFinish()};ControlKit.Range.prototype._onInputMaxChange=function(){this._updateValueMax();this._onInputChange()};ControlKit.Range.prototype._onInputMaxFinish=function(){this._updateValueMax();this._onInputFinish()};ControlKit.Checkbox=function(c,b,d,e){ControlKit.ObjectComponent.apply(this,arguments);e=e||{};e.onChange=e.onChange||this._onChange;e.onFinish=e.onFinish||this._onFinish;this._onChange=e.onChange;this._onFinish=e.onFinish;var a=this._input=new ControlKit.Node(ControlKit.NodeType.INPUT_CHECKBOX);a.setProperty("checked",this._object[this._key]);a.addEventListener(ControlKit.NodeEventType.CHANGE,this._onInputChange.bind(this));this._wrapNode.addChild(this._input)};ControlKit.Checkbox.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.Checkbox.prototype.applyValue=function(){this.pushHistoryState();var b=this._object,a=this._key;b[a]=!b[a];this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null))};ControlKit.Checkbox.prototype._onInputChange=function(){this.applyValue();this._onChange()};ControlKit.Checkbox.prototype.onValueUpdate=function(a){if(a.data.origin==this){return}this._input.setProperty("checked",this._object[this._key])};ControlKit.Slider=function(j,e,i,g,d){d=d||{};d.label=d.label||i;ControlKit.ObjectComponent.apply(this,[j,e,g,d]);this._values=this._object[this._key];this._targetKey=i;d.step=d.step||1;d.onChange=d.onChange||this._onChange;d.onFinish=d.onFinish||this._onFinish;d.dp=d.dp||2;this._step=d.step;this._onChange=d.onChange;this._onFinish=d.onFinish;this._dp=d.dp;var k=this._values,f=this._object,a=this._targetKey;var c=this._wrapNode;c.setStyleClass(ControlKit.CSS.WrapSlider);var b=this._slider=new ControlKit.Slider_Internal(c,this._onSliderBegin.bind(this),this._onSliderMove.bind(this),this._onSliderEnd.bind(this));b.setBoundMin(k[0]);b.setBoundMax(k[1]);b.setValue(f[a]);var h=this._input=new ControlKit.NumberInput_Internal(this._step,this._dp,null,this._onInputChange.bind(this),this._onInputChange.bind(this));h.setValue(f[a]);c.addChild(h.getNode());this._parent.addEventListener(ControlKit.EventType.PANEL_MOVE_END,this,"onPanelMoveEnd");this._parent.addEventListener(ControlKit.EventType.GROUP_SIZE_CHANGE,this,"onGroupWidthChange")};ControlKit.Slider.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.Slider.prototype.pushHistoryState=function(){var b=this._object,a=this._targetKey;ControlKit.History.getInstance().pushState(b,a,b[a])};ControlKit.Slider.prototype._onSliderBegin=function(){this.pushHistoryState()};ControlKit.Slider.prototype._onSliderMove=function(){this.applyValue();this._updateValueField();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null));this._onChange()};ControlKit.Slider.prototype._onSliderEnd=function(){this.applyValue();this._updateValueField();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null));this._onFinish()};ControlKit.Slider.prototype._onInputChange=function(){var b=this._input,c=this._values[0],a=this._values[1];if(b.getValue()>=a){b.setValue(a)}if(b.getValue()<=c){b.setValue(c)}var d=b.getValue();this._slider.setValue(d);this._object[this._targetKey]=d;this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null));this._onFinish()};ControlKit.Slider.prototype.applyValue=function(){var a=this._slider.getValue();this._object[this._targetKey]=a;this._input.setValue(a)};ControlKit.Slider.prototype.onValueUpdate=function(d){var b=d.data.origin;if(b==this){return}var c=this._slider;if(!(b instanceof ControlKit.Slider)){var a=this._values;if(b instanceof ControlKit.Range){c.setBoundMin(a[0]);c.setBoundMax(a[1]);this.applyValue()}else{c.setBoundMin(a[0]);c.setBoundMax(a[1]);c.setValue(this._object[this._targetKey]);this.applyValue()}}else{c.setValue(this._object[this._targetKey]);this.applyValue()}};ControlKit.Slider.prototype._updateValueField=function(){this._input.setValue(this._slider.getValue())};ControlKit.Slider.prototype.onPanelMoveEnd=ControlKit.Slider.prototype.onGroupWidthChange=function(){this._slider.resetOffset()};ControlKit.Select=function(k,c,j,b){ControlKit.ObjectComponent.apply(this,arguments);b=b||{};b.onChange=b.onChange||this._onChange;b.onFinish=b.onFinish||this._onFinish;this._onChange=b.onChange;this._onFinish=b.onFinish;var e=this._object,l=this._key;var a=this._targetKey=b.target,m=this._values=e[l];this._selected=null;var h=this._select=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON);h.setStyleClass(ControlKit.CSS.Select);h.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onSelectTrigger.bind(this));if(this._hasTarget()){var f=e[a]||"";var d=-1;while(++d<m.length){if(f==m[d]){this._selected=m[d]}}h.setProperty("value",f.toString().length>0?f:m[0])}else{h.setProperty("value",b.selected?m[b.selected]:"Choose ...")}this._wrapNode.addChild(h);var g=ControlKit.getKitInstance();g.addEventListener(ControlKit.EventType.TRIGGER_SELECT,this,"onSelectTrigger");this.addEventListener(ControlKit.EventType.SELECT_TRIGGERED,g,"onSelectTriggered")};ControlKit.Select.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.Select.prototype.onSelectTrigger=function(a){if(a.data.origin==this){this._active=!this._active;this._updateAppearance();if(this._active){this._buildOptions()}else{ControlKit.Options.getInstance().clear()}return}this._active=false;this._updateAppearance()};ControlKit.Select.prototype._buildOptions=function(){var c=ControlKit.Options.getInstance();var b=function(){this.applyValue();this._active=false;this._updateAppearance();this._onChange(c.getSelectedIndex());c.clear()}.bind(this);var a=function(){this._active=false;this._updateAppearance();c.clear()}.bind(this);c.build(this._values,this._selected,this._select,b,a,false)};ControlKit.Select.prototype.applyValue=function(){var a=ControlKit.Options.getInstance().getSelectedIndex(),b=this._selected=this._values[a];if(this._hasTarget()){this.pushHistoryState();this._object[this._targetKey]=b}this._select.setProperty("value",b);this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null))};ControlKit.Select.prototype.pushHistoryState=function(){var b=this._object,a=this._targetKey;ControlKit.History.getInstance().pushState(b,a,b[a])};ControlKit.Select.prototype._onSelectTrigger=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.SELECT_TRIGGERED,null))};ControlKit.Select.prototype._updateAppearance=function(){this._select.setStyleClass(this._active?ControlKit.CSS.SelectActive:ControlKit.CSS.Select)};ControlKit.Select.prototype.onValueUpdate=function(a){if(!this._hasTarget()){return}this._selected=this._object[this._targetKey];this._select.setProperty("value",this._selected.toString())};ControlKit.Select.prototype._hasTarget=function(){return this._targetKey!=null};ControlKit.Color=function(m,f,l,e){ControlKit.ObjectComponent.apply(this,arguments);e=e||{};e.onChange=e.onChange||this._onChange;e.onFinish=e.onFinish||this._onFinish;e.presets=e.presets||null;e.colorMode=e.colorMode||ControlKit.Default.COLOR_COLOR_MODE;this._onChange=this._onFinish=e.onChange;this._presetsKey=e.presets;var g=this._color=new ControlKit.Node(ControlKit.NodeType.DIV);var l=this._value=this._object[this._key];var h=this._colorMode=e.colorMode;this._validateColorFormat(l,ControlKit.Error.COLOR_FORMAT_HEX,ControlKit.Error.COLOR_FORMAT_RGB_RGBFV_HSV);var c=this._wrapNode;if(!this._presetsKey){g.setStyleClass(ControlKit.CSS.Color);c.addChild(g)}else{g.setStyleClass(ControlKit.CSS.Color);var p=new ControlKit.Node(ControlKit.NodeType.DIV);p.setStyleClass(ControlKit.CSS.WrapColorWPreset);c.addChild(p);p.addChild(g);var k=this._object[this._presetsKey];var j=-1;while(++j<k.length){this._validateColorFormat(k[j],ControlKit.Error.COLOR_PRESET_FORMAT_HEX,ControlKit.Error.COLOR_PRESET_FORMAT_RGB_RGBFV_HSV)}var o=ControlKit.Options.getInstance(),b=new ControlKit.PresetBtn(c);var d=function(){o.clear();b.deactivate()};var n=this;var a=function(){o.build(k,n._value,g,function(){n.pushHistoryState();n._value=k[o.getSelectedIndex()];n.applyValue()},d,ControlKit.Metric.PADDING_PRESET,true,h)};b.setOnActive(a);b.setOnDeactive(d)}g.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onColorTrigger.bind(this));this._updateColor()};ControlKit.Color.prototype=Object.create(ControlKit.ObjectComponent.prototype);ControlKit.Color.prototype._onColorTrigger=function(){var c=this._colorMode,a=ControlKit.ColorMode.HEX,d=ControlKit.ColorMode.RGB,f=ControlKit.ColorMode.RGBfv,b=ControlKit.ColorMode.HSV;var g=this._value,i;var h=function(){this.pushHistoryState();switch(c){case a:this._value=ControlKit.Picker.getInstance().getHEX();break;case d:i=ControlKit.Picker.getInstance().getRGB();g[0]=i[0];g[1]=i[1];g[2]=i[2];break;case f:i=ControlKit.Picker.getInstance().getRGBfv();g[0]=i[0];g[1]=i[1];g[2]=i[2];break;case b:this._value=ControlKit.Picker.getInstance().getHSV();break}this.applyValue()}.bind(this);var e=ControlKit.Picker.getInstance();switch(c){case a:e.setColorHEX(g);break;case d:e.setColorRGB(g[0],g[1],g[2]);break;case f:e.setColorRGBfv(g[0],g[1],g[2]);break;case b:e.setColorHSV(g[0],g[1],g[2]);break}e.setCallbackPick(h);e.open()};ControlKit.Color.prototype.applyValue=function(){this._object[this._key]=this._value;this._updateColor();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null))};ControlKit.Color.prototype.onValueUpdate=function(a){if(a.data.origin==this){return}this._value=this._object[this._key];this._updateColor()};ControlKit.Color.prototype._updateColor=function(){var a=this._value,b=this._color,c;b.setProperty("innerHTML",a);switch(this._colorMode){case ControlKit.ColorMode.HEX:c=a;break;case ControlKit.ColorMode.RGB:c=ControlKit.ColorUtil.RGB2HEX(a[0],a[1],a[2]);break;case ControlKit.ColorMode.RGBfv:c=ControlKit.ColorUtil.RGBfv2HEX(a[0],a[1],a[2]);break;case ControlKit.ColorMode.HSV:c=ControlKit.ColorUtil.HSV2RGB(a[0],a[1],a[2]);break}b.getStyle().backgroundColor=c};ControlKit.Color.prototype._validateColorFormat=function(d,a,c){var b=this._colorMode;if(b==ControlKit.ColorMode.HEX&&Object.prototype.toString.call(d)==="[object Array]"){throw new TypeError(a)}if((b==ControlKit.ColorMode.RGB||b==ControlKit.ColorMode.RGBfv||b==ControlKit.ColorMode.HSV)&&Object.prototype.toString.call(d)!=="[object Array]"){throw new TypeError(c)}};ControlKit.FunctionPlotter=function(i,v,o,u){ControlKit.Plotter.apply(this,arguments);if(ControlKit.ErrorUtil.TypeError(v,o,Function)){throw new TypeError(ControlKit.Error.COMPONENT_OBJECT+v.constructor.name+" "+o+ControlKit.Error.TYPE+"Function")}var j=v[o].length;if(j>2||j==0){throw new Error(ControlKit.Error.COMPONENT_FUNCTION_LENGTH)}u=u||{};u.showMinMaxLabels=u.hideMinMaxLabels===undefined?ControlKit.Default.PANEL_FIXED:u.hideMinMaxLabels;var k=this._svgRoot,n=this._path;var s=this._axes=k.insertBefore(this._createSVGObject("path"),n);s.style.lineWidth=1;var f=this._axesLabels=k.insertBefore(this._createSVGObject("path"),n);f.style.stroke="rgb(43,48,51)";f.style.lineWidth=1;var a=this._grid;var m=this._svg,l=Number(m.getAttribute("width"));var b=new ControlKit.Node(ControlKit.NodeType.DIV);b.setStyleClass(ControlKit.CSS.GraphSliderXWrap);var r=new ControlKit.Node(ControlKit.NodeType.DIV);r.setStyleClass(ControlKit.CSS.GraphSliderYWrap);var d=this._sliderXTrack=new ControlKit.Node(ControlKit.NodeType.DIV);d.setStyleClass(ControlKit.CSS.GraphSliderX);var g=this._sliderYTrack=new ControlKit.Node(ControlKit.NodeType.DIV);g.setStyleClass(ControlKit.CSS.GraphSliderY);var q=this._sliderXHandle=new ControlKit.Node(ControlKit.NodeType.DIV);q.setStyleClass(ControlKit.CSS.GraphSliderXHandle);var c=this._sliderYHandle=new ControlKit.Node(ControlKit.NodeType.DIV);c.setStyleClass(ControlKit.CSS.GraphSliderYHandle);d.addChild(q);g.addChild(c);b.addChild(d);r.addChild(g);var h=this._wrapNode;var t=this._plotMode=j==1?ControlKit.FunctionPlotType.NON_IMPLICIT:ControlKit.FunctionPlotType.IMPLICIT;if(t==ControlKit.FunctionPlotType.IMPLICIT){var e=this._canvas=document.createElement("canvas");e.style.width=e.style.height=l+"px";e.width=e.height=l;h.getElement().insertBefore(e,m);this._canvasContext=e.getContext("2d");this._canvasImageData=this._canvasContext.getImageData(0,0,l,l);s.style.stroke=ControlKit.Preset.FUNCTION_PLOTTER_IMPLICIT_AXES_COLOR;a.style.stroke=ControlKit.Preset.FUNCTION_PLOTTER_IMPLICIT_GRID_COLOR}else{s.style.stroke=ControlKit.Preset.FUNCTION_PLOTTER_NON_IMPLICIT_AXES_COLOR;a.style.stroke=ControlKit.Preset.FUNCTION_PLOTTER_NON_IMPLICIT_GRID_COLOR}h.addChild(b);h.addChild(r);q.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onSliderXHandleDown.bind(this));c.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onSliderYHandleDown.bind(this));var p=this._units=[null,null];this._scale=null;if(t==ControlKit.FunctionPlotType.NON_IMPLICIT){p[0]=ControlKit.Preset.FUNCTION_PLOTTER_NON_IMPLICIT_UNIT_X;p[1]=ControlKit.Preset.FUNCTION_PLOTTER_NON_IMPLICIT_UNIT_Y;this._scale=ControlKit.Preset.FUNCTION_PLOTTER_NON_IMPLICIT_SCALE}else{if(t==ControlKit.FunctionPlotType.IMPLICIT){p[0]=ControlKit.Preset.FUNCTION_PLOTTER_IMPLICIT_UNIT_X;p[1]=ControlKit.Preset.FUNCTION_PLOTTER_IMPLICIT_UNIT_Y;this._scale=ControlKit.Preset.FUNCTION_PLOTTER_IMPLICIT_SCALE}}this._unitsMinMax=[ControlKit.Preset.FUNCTION_PLOTTER_UNIT_MIN,ControlKit.Preset.FUNCTION_PLOTTER_UNIT_MAX];this._scaleMinMax=[ControlKit.Preset.FUNCTION_PLOTTER_SCALE_MIN,ControlKit.Preset.FUNCTION_PLOTTER_SCALE_MAX];this._center=[Math.round(l*0.5),Math.round(l*0.5)];this._svgPos=[0,0];this._func=null;this.setFunction(this._object[this._key]);this._sliderXHandleUpdate();this._sliderYHandleUpdate();m.addEventListener(ControlKit.DocumentEventType.MOUSE_DOWN,this._onDragStart.bind(this),false);this._wrapNode.getElement().addEventListener("mousewheel",this._onScale.bind(this,false));ControlKit.getKitInstance().addEventListener(ControlKit.EventType.UPDATE_VALUE,this,"onValueUpdate")};ControlKit.FunctionPlotter.prototype=Object.create(ControlKit.Plotter.prototype);ControlKit.FunctionPlotter.prototype._updateCenter=function(){var d=this._svg,e=Number(d.getAttribute("width")),c=Number(d.getAttribute("height"));var b=ControlKit.Mouse.getInstance().getPosition(),f=this._svgPos,a=this._center;a[0]=Math.max(0,Math.min(b[0]-f[0],e));a[1]=Math.max(0,Math.min(b[1]-f[1],c));this._plotGraph()};ControlKit.FunctionPlotter.prototype._onDragStart=function(h){var d=this._svg;var g=this._svgPos;g[0]=0;g[1]=0;while(d){g[0]+=d.offsetLeft;g[1]+=d.offsetTop;d=d.offsetParent}var a=ControlKit.DocumentEventType.MOUSE_MOVE,f=ControlKit.DocumentEventType.MOUSE_UP;var c=this._updateCenter.bind(this),b=function(){this._updateCenter.bind(this);document.removeEventListener(a,c,false);document.removeEventListener(f,b,false)}.bind(this);document.addEventListener(a,c,false);document.addEventListener(f,b,false);this._updateCenter()};ControlKit.FunctionPlotter.prototype._onScale=function(b){b=window.event||b;this._scale+=Math.max(-1,Math.min(1,(b.wheelDelta||-b.detail)))*-1;var a=this._scaleMinMax;this._scale=Math.max(a[0],Math.min(this._scale,a[1]));this._plotGraph()};ControlKit.FunctionPlotter.prototype.onValueUpdate=function(){this.setFunction(this._object[this._key])};ControlKit.FunctionPlotter.prototype._redraw=function(){if(this._plotMode==ControlKit.FunctionPlotType.IMPLICIT){var b=this._wrapNode.getWidth(),a=this._canvas;a.style.width=a.style.height=b+"px";a.width=a.height=b;this._canvasImageData=this._canvasContext.getImageData(0,0,b,b)}this._sliderXHandleUpdate();this._sliderYHandleUpdate();this.setFunction(this._object[this._key])};ControlKit.FunctionPlotter.prototype.setFunction=function(a){this._func=a.bind(this._object);this._plotGraph()};ControlKit.FunctionPlotter.prototype._plotGraph=function(){this._drawGrid();this._drawAxes();this._drawPlot()};ControlKit.FunctionPlotter.prototype._drawAxes=function(){var d=this._svg,c=Number(d.getAttribute("width")),b=Number(d.getAttribute("height"));var a=this._center,g=a[0],f=a[1];var e="";e+=this._pathCmdLine(0,f,c,f);e+=this._pathCmdLine(g,0,g,b);this._axes.setAttribute("d",e)};ControlKit.FunctionPlotter.prototype._drawPlot=function(){var p,m;var D=this._center,l=D[0],k=D[1];var r=this._units,f,e;var E=this._scale;var o,d,q,g;var z,y;var w;if(this._plotMode==ControlKit.FunctionPlotType.NON_IMPLICIT){var n=this._svg;p=Number(n.getAttribute("width"));m=Number(n.getAttribute("height"));f=r[0]*E;e=m/(r[1]*E);z=l/p;var x=Math.floor(p),v=new Array(x*2);w=-1;while(++w<x){o=(-z+w/x);d=o*f;q=k-this._func(d)*e;g=w*2;v[g]=w;v[g+1]=q}var s="";s+=this._pathCmdMoveTo(v[0],v[1]);w=2;while(w<v.length){s+=this._pathCmdLineTo(v[w],v[w+1]);w+=2}this._path.setAttribute("d",s)}else{var c=this._canvas,b=this._canvasContext,B=this._canvasImageData;p=c.width;m=c.height;f=r[0]*E;e=r[1]*E;z=l/p;y=k/m;var u=1/p,h=1/m;var a=[0,0,0];var C=[30,34,36],A=[255,255,255];w=-1;var t;while(++w<m){t=-1;while(++t<p){q=this._func((-z+t*u)*f,(-y+w*h)*e);a[0]=floor((A[0]-C[0])*q+C[0]);a[1]=floor((A[1]-C[1])*q+C[1]);a[2]=floor((A[2]-C[2])*q+C[2]);g=(w*p+t)*4;B.data[g]=a[0];B.data[g+1]=a[1];B.data[g+2]=a[2];B.data[g+3]=255}}b.clearRect(0,0,p,m);b.putImageData(B,0,0)}};ControlKit.Plotter.prototype._drawGrid=function(){var k=this._svg,o=Number(k.getAttribute("width")),j=Number(k.getAttribute("height"));var A=this._scale;var s=this._units,x=o/(s[0]*A),v=j/(s[1]*A);var y=this._center,d=y[0],c=y[1];var n=Math.round(c/v)+1,l=Math.round((j-c)/v)+1,e=Math.round(d/x)+1,h=Math.round((o-d)/x)+1;var w="",b="";var r,u;var t=ControlKit.Metric.STROKE_SIZE;var p=ControlKit.Metric.FUNCTION_PLOTTER_LABEL_TICK_SIZE,f=o-p-t,q=j-p-t,m=f-p,a=q-p,g=f-(p+t)*2,z=q-(p+t)*2;r=-1;while(++r<n){u=Math.round(c-v*r);w+=this._pathCmdLine(0,u,o,u);if(u>p){b+=this._pathCmdLine(f,u,m,u)}}r=-1;while(++r<l){u=Math.round(c+v*r);w+=this._pathCmdLine(0,u,o,u);if(u<z){b+=this._pathCmdLine(f,u,m,u)}}r=-1;while(++r<e){u=Math.round(d-x*r);w+=this._pathCmdLine(u,0,u,j);if(u>p){b+=this._pathCmdLine(u,q,u,a)}}r=-1;while(++r<h){u=Math.round(d+x*r);w+=this._pathCmdLine(u,0,u,j);if(u<g){b+=this._pathCmdLine(u,q,u,a)}}this._grid.setAttribute("d",w);this._axesLabels.setAttribute("d",b)};ControlKit.FunctionPlotter.prototype._sliderXStep=function(o){var f=o[0];var k=this._sliderXHandle,l=k.getWidth(),g=l*0.5;var e=this._sliderXTrack,p=e.getWidth(),a=e.getPositionGlobalX();var j=ControlKit.Metric.STROKE_SIZE;var n=p-g-j*2;var m=Math.max(g,Math.min(f-a,n)),b=m-g;k.setPositionX(b);var c=this._unitsMinMax[0],h=this._unitsMinMax[1];var i=(m-g)/(n-g),d=c+(h-c)*i;this._units[0]=d;this._plotGraph()};ControlKit.FunctionPlotter.prototype._sliderYStep=function(m){var e=m[1];var h=this._sliderYHandle,i=h.getHeight(),n=i*0.5;var d=this._sliderYTrack,l=d.getHeight(),o=d.getPositionGlobalY();var k=l-n-2;var j=Math.max(n,Math.min(e-o,k)),a=j-n;h.setPositionY(a);var f=this._unitsMinMax[0],b=this._unitsMinMax[1];var g=(j-n)/(k-n),c=b+(f-b)*g;this._units[1]=c;this._plotGraph()};ControlKit.FunctionPlotter.prototype._onSliderXHandleDown=function(){this._onSliderHandleDown(this._sliderXStep.bind(this))};ControlKit.FunctionPlotter.prototype._onSliderYHandleDown=function(){this._onSliderHandleDown(this._sliderYStep.bind(this))};ControlKit.FunctionPlotter.prototype._onSliderHandleDown=function(e){var f=ControlKit.DocumentEventType.MOUSE_MOVE,a=ControlKit.DocumentEventType.MOUSE_UP;var d=ControlKit.Mouse.getInstance();var c=function(){e(d.getPosition())},b=function(){document.removeEventListener(f,c,false);document.removeEventListener(a,b,false)};e(d.getPosition());document.addEventListener(f,c,false);document.addEventListener(a,b,false)};ControlKit.FunctionPlotter.prototype._sliderXHandleUpdate=function(){var b=this._unitsMinMax[0],g=this._unitsMinMax[1],i=this._units[0];var a=this._sliderXHandle,d=a.getWidth(),e=d*0.5,h=this._sliderXTrack.getWidth();var f=ControlKit.Metric.STROKE_SIZE;var j=e,c=h-e-f*2;a.setPositionX((j+(c-j)*((i-b)/(g-b)))-e)};ControlKit.FunctionPlotter.prototype._sliderYHandleUpdate=function(){var b=this._unitsMinMax[0],e=this._unitsMinMax[1],g=this._units[1];var a=this._sliderYHandle,c=a.getHeight(),i=c*0.5,h=this._sliderYTrack.getHeight();var d=ControlKit.Metric.STROKE_SIZE;var f=h-i-d*2,j=i;a.setPositionY((f+(j-f)*((g-b)/(e-b)))-i)};ControlKit.Pad=function(b,a,c,d){ControlKit.Plotter.apply(this,arguments);d=d||{};d.onChange=d.onChange||null;d.onFinish=d.onFinish||null;d.bounds=d.bounds||[-1,1,-1,1];d.axisLabels=d.axisLabels||[null,null];d.showCross=d.showCross||true;this._onChange=d.onChange||this._onChange;this._onFinish=d.onFinish||this._onFinish;this._bounds=d.bounds;this._axisLabels=d.axisLabels;this._showCross=d.showCross;this._dragging=false;this._drawValue(this._object[this._key])};ControlKit.Pad.prototype=Object.create(ControlKit.Plotter.prototype);ControlKit.Pad.prototype._redraw=function(){this._drawValue(this._object[this._key])};ControlKit.Pad.prototype._drawValue=function(a){this._object[this._key]=a};ControlKit.Pad.prototype._drawPoint=function(){};ControlKit.Pad.prototype._getMouseNormalized=function(){};ControlKit.Pad.prototype.applyValue=function(){this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.VALUE_UPDATED,null))};ControlKit.Pad.prototype.onValueUpdate=function(a){if(a.data.origin==this){return}this._drawValue(this._object[this._key])};ControlKit.ValuePlotter=function(k,d,j,c){ControlKit.Plotter.apply(this,arguments);var g=this._svg,n=Number(g.getAttribute("width")),h=Number(g.getAttribute("height"));c=c||{};c.height=c.height||h;c.resolution=c.resolution||1;var b=c.resolution,a=Math.floor(n/b);var m=this._points=new Array(a*2),o=this._buffer0=new Array(a),l=this._buffer1=new Array(a);var e=this._lineWidth*0.5;var f=-1;while(++f<a){o[f]=l[f]=m[f*2]=m[f*2+1]=e}this._height=c.height=c.height<ControlKit.Metric.COMPONENT_MIN_HEIGHT?ControlKit.Metric.COMPONENT_MIN_HEIGHT:c.height;this._svgSetSize(h,Math.floor(c.height));this._grid.style.stroke="rgb(39,44,46)";this._updateHeight();this._drawValue()};ControlKit.ValuePlotter.prototype=Object.create(ControlKit.Plotter.prototype);ControlKit.ValuePlotter.prototype._redraw=function(){var d=this._points,e=this._buffer0.length;var c=Number(this._svg.getAttribute("width")),b=c/(e-1);var a=-1;while(++a<e){d[a*2]=c-a*b}this._drawValue()};ControlKit.ValuePlotter.prototype.onGroupSizeChange=function(){var b=this._wrapNode.getWidth(),a=this._height;this._svgSetSize(b,a);this._updateHeight();this._drawGrid();this._redraw()};ControlKit.ValuePlotter.prototype._drawValue=function(){this._drawCurve()};ControlKit.ValuePlotter.prototype._drawGrid=function(){var b=this._svg;var a=Number(b.getAttribute("width")),d=Math.floor(Number(b.getAttribute("height"))*0.5);var c="";c+=this._pathCmdMoveTo(0,d);c+=this._pathCmdLineTo(a,d);this._grid.setAttribute("d",c)};ControlKit.ValuePlotter.prototype._drawCurve=function(){var c=this._svg;var h=this._object[this._key];var l=this._buffer0,k=this._buffer1,j=this._points;var a=l.length;var f="";var d=Number(c.getAttribute("height"))*0.5,g=d-this._lineWidth*0.5;j[1]=l[0];l[a-1]=(h*g)*-1+Math.floor(d);f+=this._pathCmdMoveTo(j[0],j[1]);var b=0,e;while(++b<a){e=b*2;k[b-1]=l[b];j[e+1]=l[b-1]=k[b-1];f+=this._pathCmdLineTo(j[e],j[e+1])}this._path.setAttribute("d",f)};ControlKit.ValuePlotter.prototype.update=function(){if(this._parent.isDisabled()){return}this._drawValue()};ControlKit.StringOutput=function(b,a,c,d){ControlKit.Output.apply(this,arguments)};ControlKit.StringOutput.prototype=Object.create(ControlKit.Output.prototype);ControlKit.StringOutput.prototype._setValue=function(){if(this._parent.isDisabled()){return}var a=this._object[this._key];if(a==this._prevString){return}var e=this._textArea,b=e.getElement(),d;e.setProperty("value",a);d=b.scrollHeight;e.setHeight(d);var c=this._scrollBar;if(c){if(d<=this._wrapNode.getHeight()){c.disable()}else{c.enable();c.update();c.reset()}}this._prevString=a};ControlKit.NumberOutput=function(b,a,c,d){ControlKit.Output.apply(this,arguments);d=d||{};d.dp=d.dp||2;this._valueDPlace=d.dp+1};ControlKit.NumberOutput.prototype=Object.create(ControlKit.Output.prototype);ControlKit.NumberOutput.prototype._setValue=function(){if(this._parent.isDisabled()){return}var f=this._object[this._key],g=this._textArea,h=this._valueDPlace;var c,b;if(typeof(f)==="object"&&typeof(f.length)==="number"&&typeof(f.splice)==="function"&&!(f.propertyIsEnumerable("length"))){b=f.slice();var d=-1;var a;var e=this._wrap;while(++d<b.length){a=b[d]=b[d].toString();c=a.indexOf(".");if(c>0){b[d]=a.slice(0,c+h)}}if(e){g.setStyleProperty("white-space","nowrap");b=b.join("\n")}g.setProperty("value",b)}else{b=f.toString();c=b.indexOf(".");g.setProperty("value",c>0?b.slice(0,c+h):b)}};ControlKit.Picker=function(q){var k=this._node=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Picker),F=this._headNode=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Head),x=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Wrap),l=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Label),ac=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Menu),D=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.Wrap);var G=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON);G.setStyleClass(ControlKit.CSS.MenuBtnClose);var Z=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerFieldWrap),X=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.SliderWrap),W=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerInputWrap);var c=this._canvasField=document.createElement("canvas"),s=this._canvasSlider=document.createElement("Canvas");Z.getElement().appendChild(c);X.getElement().appendChild(s);this._setSizeCanvasField(154,154);this._setSizeCanvasSlider(14,154);var T=this._contextCanvasField=c.getContext("2d"),I=this._contextCanvasSlider=s.getContext("2d");var H=this._handleField=new ControlKit.Node(ControlKit.NodeType.DIV);H.setStyleClass(ControlKit.CSS.PickerHandleField);var i=this._handleSlider=new ControlKit.Node(ControlKit.NodeType.DIV);i.setStyleClass(ControlKit.CSS.PickerHandleSlider);var K=1,j=0;var w=this._onInputHueChange.bind(this),B=this._onInputSatChange.bind(this),n=this._onInputValChange.bind(this),E=this._onInputRChange.bind(this),L=this._onInputGChange.bind(this),M=this._onInputBChange.bind(this);var t=this._inputHue=new ControlKit.NumberInput_Internal(K,j,null,w,w),y=this._inputSat=new ControlKit.NumberInput_Internal(K,j,null,B,B),g=this._inputVal=new ControlKit.NumberInput_Internal(K,j,null,n,n),S=this._inputR=new ControlKit.NumberInput_Internal(K,j,null,E,E),U=this._inputG=new ControlKit.NumberInput_Internal(K,j,null,L,L),Y=this._inputB=new ControlKit.NumberInput_Internal(K,j,null,M,M);var o=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerControlsWrap);var a=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON).setStyleClass(ControlKit.CSS.Button).setProperty("value","pick"),ab=new ControlKit.Node(ControlKit.NodeType.INPUT_BUTTON).setStyleClass(ControlKit.CSS.Button).setProperty("value","cancel");var u=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerColorContrast);var C=this._colorCurrNode=new ControlKit.Node(ControlKit.NodeType.DIV),A=this._colorPrevNode=new ControlKit.Node(ControlKit.NodeType.DIV);u.addChild(C);u.addChild(A);o.addChild(ab);o.addChild(a);o.addChild(u);this._setContrasPrevColor(0,0,0);var V=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerInputField),b=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerInputField),R=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerInputField);var e=new ControlKit.Node(ControlKit.NodeType.SPAN).setStyleClass(ControlKit.CSS.Label).setProperty("innerHTML","H"),J=new ControlKit.Node(ControlKit.NodeType.SPAN).setStyleClass(ControlKit.CSS.Label).setProperty("innerHTML","S"),Q=new ControlKit.Node(ControlKit.NodeType.SPAN).setStyleClass(ControlKit.CSS.Label).setProperty("innerHTML","V");V.addChildren(e,t.getNode());b.addChildren(J,y.getNode());R.addChildren(Q,g.getNode());var d=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerInputField),h=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerInputField),m=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerInputField);var aa=new ControlKit.Node(ControlKit.NodeType.SPAN).setStyleClass(ControlKit.CSS.Label).setProperty("innerHTML","R"),r=new ControlKit.Node(ControlKit.NodeType.SPAN).setStyleClass(ControlKit.CSS.Label).setProperty("innerHTML","G"),P=new ControlKit.Node(ControlKit.NodeType.SPAN).setStyleClass(ControlKit.CSS.Label).setProperty("innerHTML","B");d.addChildren(aa,S.getNode());h.addChildren(r,U.getNode());m.addChildren(P,Y.getNode());W.addChildren(d,V,h,b,m,R,u);var v=new ControlKit.Node(ControlKit.NodeType.DIV);v.setStyleClass(ControlKit.CSS.PickerInputWrap);var f=this._inputHEX=new ControlKit.Node(ControlKit.NodeType.INPUT_TEXT),O=new ControlKit.Node(ControlKit.NodeType.DIV).setStyleClass(ControlKit.CSS.PickerInputField),p=new ControlKit.Node(ControlKit.NodeType.SPAN).setStyleClass(ControlKit.CSS.Label);p.setProperty("innerHTML","#");O.addChildren(p,f);v.addChild(O);f.addEventListener(ControlKit.NodeEventType.CHANGE,this._onInputHEXFinish.bind(this));l.setProperty("innerHTML","Color Picker");ac.addChild(G);F.addChild(ac);x.addChild(l);F.addChild(x);k.addChild(F);k.addChild(D);D.addChild(Z);D.addChild(X);D.addChild(W);D.addChild(v);D.addChild(o);Z.addChild(H);X.addChild(i);var z=ControlKit.NodeEventType.MOUSE_DOWN,N=this._onCanvasFieldMouseDown.bind(this);Z.addEventListener(z,N);H.addEventListener(z,N);N=this._onCanvasSliderMouseDown.bind(this);X.addEventListener(z,N);i.addEventListener(z,N);G.addEventListener(z,this._onClose.bind(this));a.addEventListener(z,this._onPick.bind(this));ab.addEventListener(z,this._onClose.bind(this));F.addEventListener(ControlKit.NodeEventType.MOUSE_DOWN,this._onHeadDragStart.bind(this));this._parentNode=q;this._mouseOffset=[0,0];this._position=[0,0];this._canvasSliderPos=[0,0];this._canvasFieldPos=[0,0];this._handleFieldSize=12;this._handleSliderHeight=7;this._imageDataSlider=I.createImageData(s.width,s.height);this._imageDataField=T.createImageData(c.width,c.height);this._valueHueMinMax=[0,360];this._valueSatMinMax=this._valueValMinMax=[0,100];this._valueRGBMinMax=[0,255];this._valueHue=ControlKit.Default.COLOR_PICKER_VALUE_HUE;this._valueSat=ControlKit.Default.COLOR_PICKER_VALUE_SAT;this._valueVal=ControlKit.Default.COLOR_PICKER_VALUE_VAL;this._valueR=0;this._valueG=0;this._valueB=0;this._valueHEX="#000000";this._valueHEXValid=this._valueHEX;this._callbackPick=function(){};this._drawCanvasField();this._drawCanvasSlider();this._setColorHSV(this._valueHue,this._valueSat,this._valueVal);this._updateColorRGBFromHSV();this._updateColorHEXFromRGB();this._updateHandles()};ControlKit.Picker.prototype={_drawHandleField:function(){var e=this._canvasField,h=this._canvasFieldPos,i=ControlKit.Mouse.getInstance().getPosition();var b=Math.max(0,Math.min(i[0]-h[0],e.width)),a=Math.max(0,Math.min(i[1]-h[1],e.height)),d=b/e.width,c=a/e.height;var g=Math.round(d*this._valueSatMinMax[1]),f=Math.round((1-c)*this._valueValMinMax[1]);this._setColorHSV(this._valueHue,g,f);this._updateColorRGBFromHSV();this._updateColorHEXFromRGB();this._updateHandleField()},_updateHandleField:function(){var c=this._canvasField.width,a=this._canvasField.height,e=this._handleFieldSize*0.25;var b=this._valueSat/this._valueSatMinMax[1],d=this._valueVal/this._valueValMinMax[1];this._handleField.setPositionGlobal(b*c-e,(1-d)*a-e)},_drawHandleSlider:function(){var c=this._canvasSlider,d=this._canvasSliderPos[1],f=ControlKit.Mouse.getInstance().getY();var e=Math.max(0,Math.min(f-d,c.height)),a=e/c.height;var b=Math.floor((1-a)*this._valueHueMinMax[1]);this._setColorHSV(b,this._valueSat,this._valueVal);this._updateColorRGBFromHSV();this._updateColorHEXFromRGB();this._updateHandleSlider()},_updateHandleSlider:function(){var a=this._canvasSlider.height,c=this._handleSliderHeight*0.25;var b=this._valueHue/this._valueHueMinMax[1];this._handleSlider.setPositionGlobalY((a-c)*(1-b))},_updateHandles:function(){this._updateHandleField();this._updateHandleSlider()},_setHue:function(b){var a=this._valueHueMinMax;this._valueHue=b==a[1]?a[0]:b;this._updateColorHSV();this._drawCanvasField()},_setSat:function(a){this._valueSat=Math.round(a);this._updateColorHSV()},_setVal:function(a){this._valueVal=Math.round(a);this._updateColorHSV()},_setR:function(a){this._valueR=Math.round(a);this._updateColorRGB()},_setG:function(a){this._valueG=Math.round(a);this._updateColorRGB()},_setB:function(a){this._valueB=Math.round(a);this._updateColorRGB()},_onInputHueChange:function(){var b=this._inputHue,c=this._getValueContrained(b,this._valueHueMinMax);var a=this._valueHueMinMax;if(c==a[1]){c=a[0];b.setValue(c)}this._setHue(c);this._updateColorRGBFromHSV();this._updateColorHEXFromRGB();this._updateHandleSlider();this._drawCanvasField()},_onInputSatChange:function(){this._setSat(this._getValueContrained(this._inputSat,this._valueSatMinMax));this._onInputSVChange()},_onInputValChange:function(){this._setVal(this._getValueContrained(this._inputVal,this._valueValMinMax));this._onInputSVChange()},_onInputRChange:function(){this._setR(this._getValueContrained(this._inputR,this._valueRGBMinMax));this._onInputRGBChange()},_onInputGChange:function(){this._setG(this._getValueContrained(this._inputG,this._valueRGBMinMax));this._onInputRGBChange()},_onInputBChange:function(){this._setB(this._getValueContrained(this._inputB,this._valueRGBMinMax));this._onInputRGBChange()},_onInputHEXFinish:function(){var a=this._inputHEX,b=a.getProperty("value");if(!ControlKit.ColorUtil.isValidHEX(b)){a.setProperty("value",this._valueHEXValid);return}this._valueHEX=this._valueHEXValid=b;this._updateColorFromHEX()},_onInputSVChange:function(){this._updateColorRGBFromHSV();this._updateColorHEXFromRGB();this._updateHandleField()},_onInputRGBChange:function(){this._updateColorHSVFromRGB();this._updateColorHEXFromRGB();this._updateHandles()},_getValueContrained:function(c,b){var e=Math.round(c.getValue()),d=b[0],a=b[1];if(e<=d){e=d;c.setValue(e)}if(e>=a){e=a;c.setValue(e)}return e},_updateInputHue:function(){this._inputHue.setValue(this._valueHue)},_updateInputSat:function(){this._inputSat.setValue(this._valueSat)},_updateInputVal:function(){this._inputVal.setValue(this._valueVal)},_updateInputR:function(){this._inputR.setValue(this._valueR)},_updateInputG:function(){this._inputG.setValue(this._valueG)},_updateInputB:function(){this._inputB.setValue(this._valueB)},_updateInputHEX:function(){this._inputHEX.setProperty("value",this._valueHEX)},_setColorHSV:function(b,a,c){this._valueHue=b;this._valueSat=a;this._valueVal=c;this._updateInputHue();this._updateInputSat();this._updateInputVal();this._updateContrastCurrColor()},_setColorRGB:function(d,c,a){this._valueR=d;this._valueG=c;this._valueB=a;this._updateInputR();this._updateInputG();this._updateInputB();this._updateContrastCurrColor()},_setColorHEX:function(a){this._valueHEX=a;this._updateInputHEX()},_updateColorHSV:function(){this._setColorHSV(this._valueHue,this._valueSat,this._valueVal);this._updateContrastCurrColor()},_updateColorRGB:function(){this._setColorRGB(this._valueR,this._valueG,this._valueB);this._updateContrastCurrColor()},_updateColorHSVFromRGB:function(){var a=ControlKit.ColorUtil.RGB2HSV(this._valueR,this._valueG,this._valueB);this._setColorHSV(a[0],a[1],a[2])},_updateColorRGBFromHSV:function(){var a=ControlKit.ColorUtil.HSV2RGB(this._valueHue,this._valueSat,this._valueVal);this._setColorRGB(a[0],a[1],a[2])},_updateColorHEXFromRGB:function(){var a=ControlKit.ColorUtil.RGB2HEX(this._valueR,this._valueG,this._valueB);this._setColorHEX(a)},_updateColorFromHEX:function(){var a=ControlKit.ColorUtil.HEX2RGB(this._valueHEX);this._setColorRGB(a[0],a[1],a[2]);this._updateColorHSVFromRGB();this._updateHandles()},_updateContrastCurrColor:function(){this._setContrastCurrColor(this._valueR,this._valueG,this._valueB)},_updateContrastPrevColor:function(){this._setContrasPrevColor(this._valueR,this._valueG,this._valueB)},_setContrastCurrColor:function(d,c,a){this._colorCurrNode.setStyleProperty("background","rgb("+d+","+c+","+a+")")},_setContrasPrevColor:function(d,c,a){this._colorPrevNode.setStyleProperty("background","rgb("+d+","+c+","+a+")")},_onHeadDragStart:function(){var e=this._node,h=this._parentNode;var g=e.getPositionGlobal(),i=ControlKit.Mouse.getInstance().getPosition(),b=this._mouseOffset;b[0]=i[0]-g[0];b[1]=i[1]-g[1];var d=ControlKit.DocumentEventType.MOUSE_MOVE,a=ControlKit.DocumentEventType.MOUSE_UP;var j=this;var f=function(){j._updatePosition();j._updateCanvasNodePositions()},c=function(){j._updateCanvasNodePositions();document.removeEventListener(d,f,false);document.removeEventListener(a,c,false)};h.removeChild(e);h.addChild(e);document.addEventListener(d,f,false);document.addEventListener(a,c,false);this._updateCanvasNodePositions()},_updatePosition:function(){var i=ControlKit.Mouse.getInstance().getPosition(),c=this._mouseOffset;var e=i[0]-c[0],d=i[1]-c[1];var f=this._node,h=this._headNode,g=this._position;var b=window.innerWidth-f.getWidth(),a=window.innerHeight-h.getHeight();g[0]=Math.max(0,Math.min(e,b));g[1]=Math.max(0,Math.min(d,a));f.setPositionGlobal(g[0],g[1])},_drawCanvasField:function(){var d=this._canvasField,c=this._contextCanvasField;var b=d.width,m=d.height,n=1/b,k=1/m;var a=this._imageDataField,l=[],g=0;var h=this._valueHue;var f=-1,e;while(++f<m){e=-1;while(++e<b){l=ControlKit.ColorUtil.HSV2RGB(h,e*n*100,(1-f*k)*100);g=(f*b+e)*4;a.data[g]=l[0];a.data[g+1]=l[1];a.data[g+2]=l[2];a.data[g+3]=255}}c.putImageData(a,0,0)},_drawCanvasSlider:function(){var d=this._canvasSlider,c=this._contextCanvasSlider;var b=d.width,l=d.height,h=1/l;var a=this._imageDataSlider,k=[],g=0;var f=-1,e;while(++f<l){e=-1;while(++e<b){k=ControlKit.ColorUtil.HSV2RGB((1-f*h)*360,100,100);g=(f*b+e)*4;a.data[g]=k[0];a.data[g+1]=k[1];a.data[g+2]=k[2];a.data[g+3]=255}}c.putImageData(a,0,0)},_onCanvasFieldMouseDown:function(){var e=ControlKit.DocumentEventType.MOUSE_MOVE,a=ControlKit.DocumentEventType.MOUSE_UP;var c=this;var d=function(){c._drawHandleField()},b=function(){document.removeEventListener(e,d,false);document.removeEventListener(a,b,false)};document.addEventListener(e,d,false);document.addEventListener(a,b,false);c._drawHandleField()},_onCanvasSliderMouseDown:function(){var e=ControlKit.DocumentEventType.MOUSE_MOVE,a=ControlKit.DocumentEventType.MOUSE_UP;var c=this;var d=function(){c._drawHandleSlider();c._drawCanvasField()},b=function(){document.removeEventListener(e,d,false);document.removeEventListener(a,b,false);c._drawCanvasField()};document.addEventListener(e,d,false);document.addEventListener(a,b,false);c._drawHandleSlider();c._drawCanvasField()},_setSizeCanvasField:function(c,a){var b=this._canvasField;b.style.width=c+"px";b.style.height=a+"px";b.width=c;b.height=a},_setSizeCanvasSlider:function(c,a){var b=this._canvasSlider;b.style.width=c+"px";b.style.height=a+"px";b.width=c;b.height=a},open:function(){var a=this._node;this._parentNode.addChild(a);a.setPositionGlobal(window.innerWidth*0.5-a.getWidth()*0.5,window.innerHeight*0.5-a.getHeight()*0.5);this._updateCanvasNodePositions()},close:function(){this._parentNode.removeChild(this._node)},_onClose:function(a){a.cancelBubble=true;this.close()},_onPick:function(){this._callbackPick();this.close()},_updateCanvasNodePositions:function(){var b=this._canvasSliderPos,c=this._canvasFieldPos;b[0]=b[1]=0;c[0]=c[1]=0;var a=this._canvasSlider;while(a){b[0]+=a.offsetLeft;b[1]+=a.offsetTop;a=a.offsetParent}a=this._canvasField;while(a){c[0]+=a.offsetLeft;c[1]+=a.offsetTop;a=a.offsetParent}},setCallbackPick:function(a){this._callbackPick=a},setColorHEX:function(a){this._setColorHEX(a);this._updateColorFromHEX();this._setColor()},setColorRGB:function(d,c,a){this._setColorRGB(d,c,a);this._updateColorHEXFromRGB();this._updateColorHSVFromRGB();this._setColor()},setColorRGBfv:function(d,c,a){this.setColorRGB(Math.floor(d*255),Math.floor(c*255),Math.floor(a*255))},setColorHSV:function(c,b,a){this._setColorHSV(c,b,a);this._updateColorRGBFromHSV();this._updateColorHEXFromRGB();this._setColor()},_setColor:function(){this._drawCanvasField();this._drawCanvasSlider();this._updateHandles();this._setContrasPrevColor(this._valueR,this._valueG,this._valueB)},getR:function(){return this._valueR},getG:function(){return this._valueG},getB:function(){return this._valueB},getRGB:function(){return[this._valueR,this._valueG,this._valueB]},getHue:function(){return this._valueHue},getSat:function(){return this._valueSat},getVal:function(){return this._valueVal},getHSV:function(){return[this._valueHue,this._valueSat,this._valueVal]},getHEX:function(){return this._valueHEX},getRGBfv:function(){return[this._valueR/255,this._valueG/255,this._valueB/255]},getNode:function(){return this._node}};ControlKit.Picker.init=function(a){return ControlKit.Picker._instance=new ControlKit.Picker(a)};ControlKit.Picker.getInstance=function(){return ControlKit.Picker._instance};ControlKit.Canvas=function(c,e){ControlKit.Component.apply(this,arguments);var a=this._wrapNode;a.setStyleClass(ControlKit.CSS.CanvasWrap);var d=a.getWidth();var b=this._canvas=document.createElement("canvas");a.getElement().appendChild(b);this._canvasWidth=this._canvasHeight=0;this._setCanvasSize(d,d);this._updateHeight();this._node.setStyleClass(ControlKit.CSS.CanvasListItem);this._parent.addEventListener(ControlKit.EventType.GROUP_SIZE_CHANGE,this,"onGroupSizeChange");this.addEventListener(ControlKit.EventType.GROUP_SIZE_UPDATE,this._parent,"onGroupSizeUpdate")};ControlKit.Canvas.prototype=Object.create(ControlKit.Component.prototype);ControlKit.Canvas.prototype._updateHeight=function(){var a=this._canvas.height;this._wrapNode.setHeight(a);this._node.setHeight(a+ControlKit.Metric.PADDING_WRAPPER)};ControlKit.Canvas.prototype.onGroupSizeChange=function(){var a=this._wrapNode.getWidth();this._setCanvasSize(a,a);this._updateHeight();this._redraw();this.dispatchEvent(new ControlKit.Event(this,ControlKit.EventType.GROUP_SIZE_UPDATE,null))};ControlKit.Canvas.prototype._setCanvasSize=function(e,b){var a=this._canvasWidth=e,d=this._canvasHeight=b;var c=this._canvas;c.style.width=a+"px";c.style.height=d+"px";c.width=a;c.height=d};ControlKit.Canvas.prototype.getCanvas=function(){return this._canvas};ControlKit.Canvas.prototype.getContext=function(){return this._canvas.getContext("2d")};ControlKit.SVG=function(c,e){ControlKit.Component.apply(this,arguments);var a=this._wrapNode;a.setStyleClass(ControlKit.CSS.CanvasWrap);var d=a.getWidth();var b=this._svg=this._createSVGObject("svg");b.setAttribute("version","1.2");b.setAttribute("baseProfile","tiny");b.setAttribute("preserveAspectRatio","true");a.getElement().appendChild(b);this._svgSetSize(d,d);this._updateHeight();this._node.setStyleClass(ControlKit.CSS.CanvasListItem);this._parent.addEventListener(ControlKit.EventType.GROUP_SIZE_CHANGE,this,"onGroupSizeChange");this.addEventListener(ControlKit.EventType.GROUP_SIZE_UPDATE,this._parent,"onGroupSizeUpdate")};ControlKit.Component.prototype=Object.create(ControlKit.Component.prototype);ControlKit.SVG.prototype._updateHeight=function(){var a=Number(this._svg.getAttribute("height"));this._wrapNode.setHeight(a);this._node.setHeight(a+ControlKit.Metric.PADDING_WRAPPER)};ControlKit.SVG.prototype.onGroupSizeChange=function(){var a=this._wrapNode.getWidth();this._svgSetSize(a,a);this._updateHeight()};ControlKit.SVG.prototype._svgSetSize=function(c,a){var b=this._svg;b.setAttribute("width",c);b.setAttribute("height",a);b.setAttribute("viewbox","0 0 "+c+" "+a)};ControlKit.SVG.prototype.getSVG=function(){return this._svg};
